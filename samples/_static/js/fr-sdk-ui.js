!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("forgerock",[],t):"object"==typeof exports?exports.forgerock=t():e.forgerock=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)}([function(e,t,n){"use strict";n.r(t),n.d(t,"defaultMessageCreator",(function(){return P})),n.d(t,"nonce",(function(){return Je})),n.d(t,"AttributeInputCallback",(function(){return M})),n.d(t,"Auth",(function(){return g})),n.d(t,"CallbackType",(function(){return p})),n.d(t,"ChoiceCallback",(function(){return N})),n.d(t,"Config",(function(){return i})),n.d(t,"ConfirmationCallback",(function(){return V})),n.d(t,"Deferred",(function(){return At})),n.d(t,"DeviceProfileCallback",(function(){return F})),n.d(t,"Dispatcher",(function(){return C})),n.d(t,"ErrorCode",(function(){return d})),n.d(t,"FRAuth",(function(){return de})),n.d(t,"FRCallback",(function(){return I})),n.d(t,"FRDevice",(function(){return Pe})),n.d(t,"FRLoginFailure",(function(){return E})),n.d(t,"FRLoginSuccess",(function(){return x})),n.d(t,"FRPolicy",(function(){return T})),n.d(t,"FRStep",(function(){return se})),n.d(t,"FRUser",(function(){return rt})),n.d(t,"FRWebAuthn",(function(){return ht})),n.d(t,"HiddenValueCallback",(function(){return D})),n.d(t,"HttpClient",(function(){return Ot})),n.d(t,"KbaCreateCallback",(function(){return q})),n.d(t,"LocalStorage",(function(){return Et})),n.d(t,"MetadataCallback",(function(){return K})),n.d(t,"NameCallback",(function(){return z})),n.d(t,"OAuth2Client",(function(){return Ge})),n.d(t,"PasswordCallback",(function(){return J})),n.d(t,"PKCE",(function(){return qe})),n.d(t,"PolicyKey",(function(){return m})),n.d(t,"PollingWaitCallback",(function(){return Y})),n.d(t,"ReCaptchaCallback",(function(){return Z})),n.d(t,"ResponseType",(function(){return Be})),n.d(t,"SessionManager",(function(){return Tt})),n.d(t,"StepType",(function(){return O})),n.d(t,"TermsAndConditionsCallback",(function(){return te})),n.d(t,"TextOutputCallback",(function(){return re})),n.d(t,"TokenManager",(function(){return Ze})),n.d(t,"TokenStorage",(function(){return Ue})),n.d(t,"UserManager",(function(){return et})),n.d(t,"ValidatedCreatePasswordCallback",(function(){return ie})),n.d(t,"ValidatedCreateUsernameCallback",(function(){return ue})),n.d(t,"WebAuthnOutcome",(function(){return ze})),n.d(t,"WebAuthnStepType",(function(){return Qe}));var r,o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=function(){function e(){}return e.set=function(e){if(!this.isValid(e))throw new Error("Configuration is invalid");e.serverConfig&&this.validateServerConfig(e.serverConfig),this.options=o({},e)},e.get=function(e){if(!this.options&&!e)throw new Error("Configuration has not been set");var t=o(o({},this.options),e);if(!t.serverConfig||!t.serverConfig.baseUrl)throw new Error("Server configuration has not been set");return t},e.isValid=function(e){return!(!e||!e.serverConfig)},e.validateServerConfig=function(e){e.timeout||(e.timeout=6e4);var t=e.baseUrl;t&&"/"!==t.charAt(t.length-1)&&(e.baseUrl=t+"/")},e}();!function(e){e.Authenticate="AUTHENTICATE",e.Authorize="AUTHORIZE",e.Logout="LOGOUT",e.ExchangeToken="EXCHANGE_TOKEN",e.RefreshToken="REFRESH_TOKEN",e.RevokeToken="REVOKE_TOKEN",e.StartAuthenticate="START_AUTHENTICATE",e.UserInfo="USER_INFO"}(r||(r={}));function a(e,t){void 0===t&&(t=6e4);var n=t||6e4;return Promise.race([e,new Promise((function(e,t){return window.setTimeout((function(){return t(new Error("Timeout"))}),n)}))])}var u=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function c(e){var t="http:"===e.protocol&&-1===["","80"].indexOf(e.port)||"https:"===e.protocol&&-1===["","443"].indexOf(e.port)?":"+e.port:"";return e.protocol+"//"+e.hostname+t}function s(e,t,n){var r=function(e){var t=(e||"").split("/").map((function(e){return e.trim()})).filter((function(e){return""!==e}));return"root"!==t[0]&&t.unshift("root"),t.map((function(e){return"realms/"+e})).join("/")}(t),o={authenticate:"json/"+r+"/authenticate",authorize:"oauth2/"+r+"/authorize",accessToken:"oauth2/"+r+"/access_token",endSession:"oauth2/"+r+"/connect/endSession",userInfo:"oauth2/"+r+"/userinfo",revoke:"oauth2/"+r+"/token/revoke",sessions:"json/"+r+"/sessions/"};return n&&n[e]?n[e]:o[e]}function l(e,t){var n=new URL(e);if(t.startsWith("/"))return""+c(n)+t;var r=n.pathname.split("/"),o=t.split("/").filter((function(e){return!!e})),i=u(r.slice(0,-1),o).join("/");return""+c(n)+i}function f(e){var t=[];for(var n in e)e[n]&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}var d,p,h=function(e,t,n){var r=i.get().middleware;if(!Array.isArray(r))return e;var o=Object.freeze({type:t,payload:n}),a=r.map((function(e){return e}));return function t(){var n=a.shift();return n&&n(e,o,t),e}()},b=function(){return(b=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},y=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},v=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},g=function(){function e(){}return e.next=function(e,t){return y(this,void 0,void 0,(function(){var n,o,u,c,s,l,f,d,p;return v(this,(function(b){switch(b.label){case 0:return n=i.get(t),o=n.realmPath,u=n.serverConfig,c=n.tree,s=n.type,l=t?t.query:{},f=this.constructUrl(u,o,c,l),d=h({url:new URL(f),init:this.configureRequest(e)},e?r.Authenticate:r.StartAuthenticate,{tree:c,type:s||"service"}),[4,a(fetch(d.url.toString(),d.init),u.timeout)];case 1:return p=b.sent(),[4,this.getResponseJson(p)];case 2:return[2,b.sent()]}}))}))},e.constructUrl=function(e,t,n,r){var o=n?{authIndexType:"service",authIndexValue:n}:void 0,i=b(b({},r),o),a=Object.keys(i).length>0?"?"+f(i):"",u=s("authenticate",t,e.paths);return l(e.baseUrl,""+u+a)},e.configureRequest=function(e){return{body:e?JSON.stringify(e):void 0,credentials:"include",headers:{accept:"application/json","accept-api-version":"protocol=1.0,resource=2.1","content-type":"application/json","x-requested-with":"forgerock-sdk"},method:"POST"}},e.getResponseJson=function(e){return y(this,void 0,void 0,(function(){var t,n,r;return v(this,(function(o){switch(o.label){case 0:return t=e.headers.get("content-type"),t&&t.indexOf("application/json")>-1?[4,e.json()]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r={},o.label=3;case 3:return(n=r).status=e.status,n.ok=e.ok,[2,n]}}))}))},e}();!function(e){e.BadRequest="BAD_REQUEST",e.Timeout="TIMEOUT",e.Unauthorized="UNAUTHORIZED",e.Unknown="UNKNOWN"}(d||(d={})),function(e){e.BooleanAttributeInputCallback="BooleanAttributeInputCallback",e.ChoiceCallback="ChoiceCallback",e.ConfirmationCallback="ConfirmationCallback",e.DeviceProfileCallback="DeviceProfileCallback",e.HiddenValueCallback="HiddenValueCallback",e.KbaCreateCallback="KbaCreateCallback",e.MetadataCallback="MetadataCallback",e.NameCallback="NameCallback",e.PasswordCallback="PasswordCallback",e.PollingWaitCallback="PollingWaitCallback",e.ReCaptchaCallback="ReCaptchaCallback",e.StringAttributeInputCallback="StringAttributeInputCallback",e.TermsAndConditionsCallback="TermsAndConditionsCallback",e.TextOutputCallback="TextOutputCallback",e.ValidatedCreatePasswordCallback="ValidatedCreatePasswordCallback",e.ValidatedCreateUsernameCallback="ValidatedCreateUsernameCallback"}(p||(p={}));var m,w,C=function(){function e(){this.callbacks={}}return e.prototype.addEventListener=function(e,t){!function(e,t,n){e[t]=e[t]||[],e[t].indexOf(n)<0&&e[t].push(n)}(this.callbacks,e,t)},e.prototype.removeEventListener=function(e,t){!function(e,t,n){if(e[t]){var r=e[t].indexOf(n);r>=0&&e[t].splice(r,1)}}(this.callbacks,e,t)},e.prototype.clearEventListeners=function(e){!function(e,t){Object.keys(e).forEach((function(n){t&&n!==t||delete e[n]}))}(this.callbacks,e)},e.prototype.dispatchEvent=function(e){if(this.callbacks[e.type])for(var t=0,n=this.callbacks[e.type];t<n.length;t++){(0,n[t])(e)}},e}();function k(e,t,n){return 1===e?t:void 0!==n?n:t+"s"}function _(e,t,n){return e&&void 0!==e[t]?e[t]:n}!function(e){e.CannotContainCharacters="CANNOT_CONTAIN_CHARACTERS",e.CannotContainDuplicates="CANNOT_CONTAIN_DUPLICATES",e.CannotContainOthers="CANNOT_CONTAIN_OTHERS",e.LeastCapitalLetters="AT_LEAST_X_CAPITAL_LETTERS",e.LeastNumbers="AT_LEAST_X_NUMBERS",e.MatchRegexp="MATCH_REGEXP",e.MaximumLength="MAX_LENGTH",e.MaximumNumber="MAXIMUM_NUMBER_VALUE",e.MinimumLength="MIN_LENGTH",e.MinimumNumber="MINIMUM_NUMBER_VALUE",e.Required="REQUIRED",e.Unique="UNIQUE",e.UnknownPolicy="UNKNOWN_POLICY",e.ValidArrayItems="VALID_ARRAY_ITEMS",e.ValidDate="VALID_DATE",e.ValidEmailAddress="VALID_EMAIL_ADDRESS_FORMAT",e.ValidNameFormat="VALID_NAME_FORMAT",e.ValidNumber="VALID_NUMBER",e.ValidPhoneFormat="VALID_PHONE_FORMAT",e.ValidQueryFilter="VALID_QUERY_FILTER",e.ValidType="VALID_TYPE"}(m||(m={}));var O,P=((w={})[m.CannotContainCharacters]=function(e,t){return e+' must not contain following characters: "'+_(t,"forbiddenChars","")+'"'},w[m.CannotContainDuplicates]=function(e,t){return e+'  must not contain duplicates: "'+_(t,"duplicateValue","")+'"'},w[m.CannotContainOthers]=function(e,t){return e+' must not contain: "'+_(t,"disallowedFields","")+'"'},w[m.LeastCapitalLetters]=function(e,t){var n=_(t,"numCaps",0);return e+" must contain at least "+n+" capital "+k(n,"letter")},w[m.LeastNumbers]=function(e,t){var n=_(t,"numNums",0);return e+" must contain at least "+n+" numeric "+k(n,"value")},w[m.MatchRegexp]=function(e){return e+' has failed the "MATCH_REGEXP" policy'},w[m.MaximumLength]=function(e,t){var n=_(t,"maxLength",0);return e+" must be at most "+n+" "+k(n,"character")},w[m.MaximumNumber]=function(e){return e+' has failed the "MAXIMUM_NUMBER_VALUE" policy'},w[m.MinimumLength]=function(e,t){var n=_(t,"minLength",0);return e+" must be at least "+n+" "+k(n,"character")},w[m.MinimumNumber]=function(e){return e+' has failed the "MINIMUM_NUMBER_VALUE" policy'},w[m.Required]=function(e){return e+" is required"},w[m.Unique]=function(e){return e+" must be unique"},w[m.UnknownPolicy]=function(e,t){return e+': Unknown policy requirement "'+_(t,"policyRequirement","Unknown")+'"'},w[m.ValidArrayItems]=function(e){return e+' has failed the "VALID_ARRAY_ITEMS" policy'},w[m.ValidDate]=function(e){return e+" has an invalid date"},w[m.ValidEmailAddress]=function(e){return e+" has an invalid email address"},w[m.ValidNameFormat]=function(e){return e+" has an invalid name format"},w[m.ValidNumber]=function(e){return e+" has an invalid number"},w[m.ValidPhoneFormat]=function(e){return e+" has an invalid phone number"},w[m.ValidQueryFilter]=function(e){return e+' has failed the "VALID_QUERY_FILTER" policy'},w[m.ValidType]=function(e){return e+' has failed the "VALID_TYPE" policy'},w),S=function(){return(S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},T=function(){function e(){}return e.parseErrors=function(e,t){var n=this,r=[];return e.detail&&e.detail.failedPolicyRequirements&&e.detail.failedPolicyRequirements.map((function(e){r.push.apply(r,[{detail:e,messages:n.parseFailedPolicyRequirement(e,t)}])})),r},e.parseFailedPolicyRequirement=function(e,t){var n=this,r=[];return e.policyRequirements.map((function(o){r.push(n.parsePolicyRequirement(e.property,o,t))})),r},e.parsePolicyRequirement=function(e,t,n){void 0===n&&(n={});var r="string"==typeof t?JSON.parse(t):S({},t),o=r.policyRequirement;return(n[o]||P[o]||P[m.UnknownPolicy])(e,r.params?S(S({},r.params),{policyRequirement:o}):{policyRequirement:o})},e}();!function(e){e.LoginFailure="LoginFailure",e.LoginSuccess="LoginSuccess",e.Step="Step"}(O||(O={}));var A,E=function(){function e(e){this.payload=e,this.type=O.LoginFailure}return e.prototype.getCode=function(){return Number(this.payload.code)},e.prototype.getDetail=function(){return this.payload.detail},e.prototype.getMessage=function(){return this.payload.message},e.prototype.getProcessedMessage=function(e){return T.parseErrors(this.payload,e)},e.prototype.getReason=function(){return this.payload.reason},e}(),x=function(){function e(e){this.payload=e,this.type=O.LoginSuccess}return e.prototype.getRealm=function(){return this.payload.realm},e.prototype.getSessionToken=function(){return this.payload.tokenId},e.prototype.getSuccessUrl=function(){return this.payload.successUrl},e}(),I=function(){function e(e){this.payload=e}return e.prototype.getType=function(){return this.payload.type},e.prototype.getInputValue=function(e){return void 0===e&&(e=0),this.getArrayElement(this.payload.input,e).value},e.prototype.setInputValue=function(e,t){void 0===t&&(t=0),this.getArrayElement(this.payload.input,t).value=e},e.prototype.getOutputValue=function(e){return void 0===e&&(e=0),this.getArrayElement(this.payload.output,e).value},e.prototype.getOutputByName=function(e,t){var n=this.payload.output.find((function(t){return t.name===e}));return n?n.value:t},e.prototype.getArrayElement=function(e,t){if(void 0===t&&(t=0),void 0===e)throw new Error("No NameValue array was provided to search (selector "+t+")");if("number"==typeof t){if(t<0||t>e.length-1)throw new Error("Selector index "+t+" is out of range");return e[t]}if("string"==typeof t){var n=e.find((function(e){return e.name===t}));if(!n)throw new Error('Missing callback input entry "'+t+'"');return n}throw new Error("Invalid selector value type")},e}(),R=(A=function(e,t){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}A(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),M=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return R(t,e),t.prototype.getName=function(){return this.getOutputByName("name","")},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.setValue=function(e){this.setInputValue(e)},t}(I),j=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return j(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getDefaultChoice=function(){return this.getOutputByName("defaultChoice",0)},t.prototype.getChoices=function(){return this.getOutputByName("choices",[])},t.prototype.setChoiceIndex=function(e){var t=this.getChoices().length;if(e<0||e>t-1)throw new Error(e+" is out of bounds");this.setInputValue(e)},t.prototype.setChoiceValue=function(e){var t=this.getChoices().indexOf(e);if(-1===t)throw new Error('"'+e+'" is not a valid choice');this.setInputValue(t)},t}(I),L=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),V=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return L(t,e),t.prototype.getDefaultOption=function(){return Number(this.getOutputByName("defaultOption",0))},t.prototype.getMessageType=function(){return Number(this.getOutputByName("messageType",0))},t.prototype.getOptions=function(){return this.getOutputByName("options",[])},t.prototype.getOptionType=function(){return Number(this.getOutputByName("optionType",0))},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.setOptionIndex=function(e){if(0!==e&&1!==e)throw new Error('"'+e+'" is not a valid choice');this.setInputValue(e)},t.prototype.setOptionValue=function(e){var t=this.getOptions().indexOf(e);if(-1===t)throw new Error('"'+e+'" is not a valid choice');this.setInputValue(t)},t}(I),U=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),F=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return U(t,e),t.prototype.getMessage=function(){return this.getOutputByName("message","")},t.prototype.isMetadataRequired=function(){return this.getOutputByName("metadata",!1)},t.prototype.isLocationRequired=function(){return this.getOutputByName("location",!1)},t.prototype.setProfile=function(e){this.setInputValue(JSON.stringify(e))},t}(I),B=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),D=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return B(t,e),t}(I),H=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),q=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return H(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getPredefinedQuestions=function(){return this.getOutputByName("predefinedQuestions",[])},t.prototype.setQuestion=function(e){this.setValue("question",e)},t.prototype.setAnswer=function(e){this.setValue("answer",e)},t.prototype.setValue=function(e,t){if(!this.payload.input)throw new Error("KBA payload is missing input");var n=this.payload.input.find((function(t){return t.name.endsWith(e)}));if(!n)throw new Error('No input has name ending in "'+e+'"');n.value=t},t}(I),W=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),K=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return W(t,e),t.prototype.getData=function(){return this.getOutputByName("data",{})},t}(I),G=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),z=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return G(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.setName=function(e){this.setInputValue(e)},t}(I),Q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),J=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return Q(t,e),t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.setPassword=function(e){this.setInputValue(e)},t}(I),X=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Y=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return X(t,e),t.prototype.getMessage=function(){return this.getOutputByName("message","")},t.prototype.getWaitTime=function(){return Number(this.getOutputByName("waitTime",0))},t}(I),$=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Z=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return $(t,e),t.prototype.getSiteKey=function(){return this.getOutputByName("recaptchaSiteKey","")},t.prototype.setResult=function(e){this.setInputValue(e)},t}(I),ee=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),te=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return ee(t,e),t.prototype.getTerms=function(){return this.getOutputByName("terms","")},t.prototype.getVersion=function(){return this.getOutputByName("version","")},t.prototype.getCreateDate=function(){var e=this.getOutputByName("createDate","");return new Date(e)},t.prototype.setAccepted=function(e){void 0===e&&(e=!0),this.setInputValue(e)},t}(I),ne=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return ne(t,e),t.prototype.getMessage=function(){return this.getOutputByName("message","")},t.prototype.getMessageType=function(){return this.getOutputByName("messageType","")},t}(I),oe=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ie=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return oe(t,e),t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.setPassword=function(e){this.setInputValue(e)},t}(I),ae=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ue=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return ae(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.setName=function(e){this.setInputValue(e)},t}(I);var ce=function(e){switch(e.type){case p.BooleanAttributeInputCallback:return new M(e);case p.ChoiceCallback:return new N(e);case p.ConfirmationCallback:return new V(e);case p.DeviceProfileCallback:return new F(e);case p.HiddenValueCallback:return new D(e);case p.KbaCreateCallback:return new q(e);case p.MetadataCallback:return new K(e);case p.NameCallback:return new z(e);case p.PasswordCallback:return new J(e);case p.PollingWaitCallback:return new Y(e);case p.ReCaptchaCallback:return new Z(e);case p.StringAttributeInputCallback:return new M(e);case p.TermsAndConditionsCallback:return new te(e);case p.TextOutputCallback:return new re(e);case p.ValidatedCreatePasswordCallback:return new ie(e);case p.ValidatedCreateUsernameCallback:return new ue(e);default:return new I(e)}},se=function(){function e(e,t){this.payload=e,this.type=O.Step,this.callbacks=[],e.callbacks&&(this.callbacks=this.convertCallbacks(e.callbacks,t))}return e.prototype.getCallbackOfType=function(e){var t=this.getCallbacksOfType(e);if(1!==t.length)throw new Error('Expected 1 callback of type "'+e+'", but found '+t.length);return t[0]},e.prototype.getCallbacksOfType=function(e){return this.callbacks.filter((function(t){return t.getType()===e}))},e.prototype.setCallbackValue=function(e,t){var n=this.getCallbacksOfType(e);if(1!==n.length)throw new Error('Expected 1 callback of type "'+e+'", but found '+n.length);n[0].setInputValue(t)},e.prototype.getDescription=function(){return this.payload.description},e.prototype.getHeader=function(){return this.payload.header},e.prototype.getStage=function(){return this.payload.stage},e.prototype.convertCallbacks=function(e,t){return e.map((function(e){return(t||ce)(e)||ce(e)}))},e}(),le=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},fe=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},de=function(){function e(){}return e.next=function(e,t){return le(this,void 0,void 0,(function(){var n,r;return fe(this,(function(o){switch(o.label){case 0:return[4,g.next(e?e.payload:void 0,t)];case 1:return(n=o.sent()).authId?(r=t?t.callbackFactory:void 0,[2,new se(n,r)]):!n.authId&&n.ok?[2,new x(n)]:[2,new E(n)]}}))}))},e}(),pe=["userAgent","appName","appCodeName","appVersion","appMinorVersion","buildID","product","productSub","vendor","vendorSub","browserLanguage"],he=["fontNames","displayProps","browserProps","hardwareProps","platformProps"],be={mac:["Macintosh","MacIntel","MacPPC","Mac68K"],windows:["Win32","Win64","Windows","WinCE"],ios:["iPhone","iPad","iPod"]},ye=["width","height","pixelDepth","orientation.angle"],ve=["cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona"],ge=["cpuClass","deviceMemory","hardwareConcurrency","maxTouchPoints","oscpu"],me=["language","platform","userLanguage","systemLanguage"],we=function(){function e(){}return e.prototype.reduceToObject=function(e,t){return e.reduce((function(e,n){if(n.includes(".")){var r=n.split("."),o=r[0],i=r[1],a=t[o]&&t[o][i];e[i]=null!=a?a:""}else e[n]=null!=t[n]?t[n]:null;return e}),{})},e.prototype.reduceToString=function(e,t){return e.reduce((function(e,n){return e=""+e+t[n].filename+";"}),"")},e}(),Ce=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ke=function(){return(ke=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},_e=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},Oe=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Pe=function(e){function t(t){var n=e.call(this)||this;return n.config={fontNames:ve,devicePlatforms:be,displayProps:ye,browserProps:pe,hardwareProps:ge,platformProps:me},t&&Object.keys(t).forEach((function(e){if(!he.includes(e))throw new Error("Device profile configuration category does not exist.");n.config[e]=t[e]})),n}return Ce(t,e),t.prototype.getBrowserMeta=function(){return navigator?this.reduceToObject(this.config.browserProps,navigator):(console.warn("Cannot collect browser metadata. navigator is not defined."),{})},t.prototype.getBrowserPluginsNames=function(){return navigator&&navigator.plugins?this.reduceToString(Object.keys(navigator.plugins),navigator.plugins):(console.warn("Cannot collect browser plugin information. navigator.plugins is not defined."),"")},t.prototype.getDeviceName=function(){if(!navigator)return console.warn("Cannot collect device name. navigator is not defined."),"";var e=navigator.userAgent,t=navigator.platform;switch(!0){case this.config.devicePlatforms.mac.includes(t):return"Mac (Browser)";case this.config.devicePlatforms.ios.includes(t):return t+" (Browser)";case this.config.devicePlatforms.windows.includes(t):return"Windows (Browser)";case/Android/.test(t)||/Android/.test(e):return"Android (Browser)";case/CrOS/.test(e)||/Chromebook/.test(e):return"Chrome OS (Browser)";case/Linux/.test(t):return"Linux (Browser)";default:return(t||"Unknown")+" (Browser)"}},t.prototype.getDisplayMeta=function(){return screen||console.warn("Cannot collect screen information. screen is not defined."),this.reduceToObject(this.config.displayProps,screen)},t.prototype.getHardwareMeta=function(){return navigator?this.reduceToObject(this.config.hardwareProps,navigator):(console.warn("Cannot collect OS metadata. Navigator is not defined."),{})},t.prototype.getIdentifier=function(){if(!window.crypto||!window.crypto.getRandomValues)return console.warn("Cannot generate profile ID. Crypto and/or getRandomValues is not supported."),"";if(!localStorage)return console.warn("Cannot store profile ID. localStorage is not supported."),"";var e=localStorage.getItem("profile-id");return e||(e=window.crypto.getRandomValues(new Uint32Array(3)).join("-"),localStorage.setItem("profile-id",e)),e},t.prototype.getInstalledFonts=function(){var e=document.createElement("canvas");if(!e)return console.warn("Cannot collect font data. Browser does not support canvas element"),"";var t=e.getContext&&e.getContext("2d");if(!t)return console.warn("Cannot collect font data. Browser does not support 2d canvas context"),"";var n="abcdefghi0123456789";t.font="72px Comic Sans";var r=t.measureText(n).width;return this.config.fontNames.reduce((function(e,o){return t.font="72px "+o+", Comic Sans",t.measureText(n).width!==r&&(e=""+e+o+";"),e}),"")},t.prototype.getLocationCoordinates=function(){return _e(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return navigator&&navigator.geolocation?[2,new Promise((function(t){return _e(e,void 0,void 0,(function(){return Oe(this,(function(e){return navigator.geolocation.getCurrentPosition((function(e){return t({latitude:e.coords.latitude,longitude:e.coords.longitude})}),(function(e){console.warn("Cannot collect geolocation information. "+e.code+": "+e.message),t({})}),{enableHighAccuracy:!0,timeout:3e4,maximumAge:0}),[2]}))}))}))]:(console.warn("Cannot collect geolocation information. navigator.geolocation is not defined."),[2,Promise.resolve({})])}))}))},t.prototype.getOSMeta=function(){return navigator?this.reduceToObject(this.config.platformProps,navigator):(console.warn("Cannot collect OS metadata. navigator is not defined."),{})},t.prototype.getProfile=function(e){var t=e.location,n=e.metadata;return _e(this,void 0,void 0,(function(){var e,r;return Oe(this,(function(o){switch(o.label){case 0:return e={identifier:this.getIdentifier()},n&&(e.metadata={hardware:ke(ke({},this.getHardwareMeta()),{display:this.getDisplayMeta()}),browser:ke(ke({},this.getBrowserMeta()),{plugins:this.getBrowserPluginsNames()}),platform:ke(ke({},this.getOSMeta()),{deviceName:this.getDeviceName(),fonts:this.getInstalledFonts(),timezone:this.getTimezoneOffset()})}),t?(r=e,[4,this.getLocationCoordinates()]):[3,2];case 1:r.location=o.sent(),o.label=2;case 2:return[2,e]}}))}))},t.prototype.getTimezoneOffset=function(){try{return(new Date).getTimezoneOffset()}catch(e){return console.warn("Cannot collect timezone information. getTimezoneOffset is not defined."),null}},t}(we),Se="forgerock-sdk",Te=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},Ae=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ee=function(){function e(){}return e.get=function(e){return Te(this,void 0,void 0,(function(){return Ae(this,(function(t){return[2,new Promise((function(t,n){var r=function(){return n()},o=window.indexedDB.open(Se);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(e))return o.result.close(),t(void 0);var n=o.result.transaction(e,"readonly").objectStore(e).get("tokens");n.onsuccess=function(e){if(!e||!e.target)throw new Error("Missing storage event target");o.result.close(),t(e.target.result)},n.onerror=r},o.onupgradeneeded=function(){o.result.close(),t(void 0)},o.onerror=r}))]}))}))},e.set=function(e,t){return Te(this,void 0,void 0,(function(){return Ae(this,(function(n){return[2,new Promise((function(n,r){var o=window.indexedDB.open(Se),i=function(){o.result.close(),n()},a=function(){return r()},u=function(){o.result.createObjectStore(e)},c=function(){if(!o.result.objectStoreNames.contains(e)){var n=o.result.version+1;return o.result.close(),(o=window.indexedDB.open(Se,n)).onupgradeneeded=u,o.onsuccess=c,void(o.onerror=a)}var r=o.result.transaction(e,"readwrite");r.onerror=a;var s=r.objectStore(e).put(t,"tokens");s.onsuccess=i,s.onerror=a};o.onupgradeneeded=u,o.onsuccess=c,o.onerror=a}))]}))}))},e.remove=function(e){return Te(this,void 0,void 0,(function(){return Ae(this,(function(t){return[2,new Promise((function(t,n){var r=function(){return n()},o=window.indexedDB.open(Se);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(e))return t();var n=o.result.transaction(e,"readwrite").objectStore(e).delete("tokens");n.onsuccess=function(){t()},n.onerror=r},o.onerror=r}))]}))}))},e}(),xe=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},Ie=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Re=function(){function e(){}return e.get=function(e){return xe(this,void 0,void 0,(function(){var t;return Ie(this,(function(n){t=localStorage.getItem(Se+"-"+e);try{return[2,Promise.resolve(JSON.parse(t||""))]}catch(e){return console.warn("Could not parse token from localStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]}))}))},e.set=function(e,t){return xe(this,void 0,void 0,(function(){var n;return Ie(this,(function(r){return n=JSON.stringify(t),localStorage.setItem(Se+"-"+e,n),[2]}))}))},e.remove=function(e){return xe(this,void 0,void 0,(function(){return Ie(this,(function(t){return localStorage.removeItem(Se+"-"+e),[2]}))}))},e}(),Me=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},je=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ne=function(){function e(){}return e.get=function(e){return Me(this,void 0,void 0,(function(){var t;return je(this,(function(n){t=sessionStorage.getItem(Se+"-"+e);try{return[2,Promise.resolve(JSON.parse(t||""))]}catch(e){return console.warn("Could not parse token from sessionStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]}))}))},e.set=function(e,t){return Me(this,void 0,void 0,(function(){var n;return je(this,(function(r){return n=JSON.stringify(t),sessionStorage.setItem(Se+"-"+e,n),[2]}))}))},e.remove=function(e){return Me(this,void 0,void 0,(function(){return je(this,(function(t){return sessionStorage.removeItem(Se+"-"+e),[2]}))}))},e}(),Le=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},Ve=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ue=function(){function e(){}return e.get=function(){return Le(this,void 0,void 0,(function(){var e,t,n;return Ve(this,(function(r){switch(r.label){case 0:return e=this.getClientConfig(),t=e.clientId,"sessionStorage"!==(n=e.tokenStore)?[3,2]:[4,Ne.get(t)];case 1:return[2,r.sent()];case 2:return"localStorage"!==n?[3,4]:[4,Re.get(t)];case 3:return[2,r.sent()];case 4:return"indexedDB"!==n?[3,6]:[4,Ee.get(t)];case 5:return[2,r.sent()];case 6:return n&&n.get?[4,n.get(t)]:[3,8];case 7:return[2,r.sent()];case 8:return[4,Ee.get(t)];case 9:return[2,r.sent()]}}))}))},e.set=function(e){return Le(this,void 0,void 0,(function(){var t,n,r;return Ve(this,(function(o){switch(o.label){case 0:return t=this.getClientConfig(),n=t.clientId,"sessionStorage"!==(r=t.tokenStore)?[3,2]:[4,Ne.set(n,e)];case 1:return[2,o.sent()];case 2:return"localStorage"!==r?[3,4]:[4,Re.set(n,e)];case 3:return[2,o.sent()];case 4:return"indexedDB"!==r?[3,6]:[4,Ee.set(n,e)];case 5:return[2,o.sent()];case 6:return r&&r.set?[4,r.set(n,e)]:[3,8];case 7:return[2,o.sent()];case 8:return[4,Ee.set(n,e)];case 9:return[2,o.sent()]}}))}))},e.remove=function(){return Le(this,void 0,void 0,(function(){var e,t,n;return Ve(this,(function(r){switch(r.label){case 0:return e=this.getClientConfig(),t=e.clientId,"sessionStorage"!==(n=e.tokenStore)?[3,2]:[4,Ne.remove(t)];case 1:return[2,r.sent()];case 2:return"localStorage"!==n?[3,4]:[4,Re.remove(t)];case 3:return[2,r.sent()];case 4:return"indexedDB"!==n?[3,6]:[4,Ee.remove(t)];case 5:return[2,r.sent()];case 6:return n&&n.remove?[4,n.remove(t)]:[3,8];case 7:return[2,r.sent()];case 8:return[4,Ee.remove(t)];case 9:return[2,r.sent()]}}))}))},e.getClientConfig=function(){var e=i.get(),t=e.clientId,n=e.tokenStore;if(!t)throw new Error("clientId is required to manage token storage");return{clientId:t,tokenStore:n}},e}();function Fe(e){return e.ok||4===Math.floor(e.status/100)}var Be,De=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},He=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},qe=function(){function e(){}return e.createVerifier=function(e){void 0===e&&(e=32);var t=new Uint8Array(e);return window.crypto.getRandomValues(t),this.base64UrlEncode(t)},e.createChallenge=function(e){return De(this,void 0,void 0,(function(){var t;return He(this,(function(n){switch(n.label){case 0:return[4,this.sha256(e)];case 1:return t=n.sent(),[2,this.base64UrlEncode(t)]}}))}))},e.base64UrlEncode=function(e){var t=Array.prototype.slice.call(e);return window.btoa(String.fromCharCode.apply(null,t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},e.sha256=function(e){return De(this,void 0,void 0,(function(){var t,n;return He(this,(function(r){switch(r.label){case 0:return t=(new TextEncoder).encode(e),[4,window.crypto.subtle.digest("SHA-256",t)];case 1:return n=r.sent(),[2,new Uint8Array(n)]}}))}))},e}();!function(e){e.Code="code",e.Token="token"}(Be||(Be={}));var We=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},Ke=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ge=function(){function e(){}return e.getAuthorizeUrl=function(e){return We(this,void 0,void 0,(function(){var t,n,o,a,u,c,s,l,f=this;return Ke(this,(function(d){switch(d.label){case 0:return t=i.get(e),n=t.serverConfig,o=t.clientId,a=t.redirectUri,u=t.scope,c={client_id:o,redirect_uri:a,response_type:e.responseType,scope:u,state:e.state},e.verifier?[4,qe.createChallenge(e.verifier)]:[3,2];case 1:s=d.sent(),c.code_challenge=s,c.code_challenge_method="S256",d.label=2;case 2:return l=h({url:new URL(this.getUrl("authorize",c,e)),init:{}},r.Authorize).url,[2,new Promise((function(e,t){var r,o=document.createElement("iframe"),i=function(){},a=i,u=0;r=function(){window.clearTimeout(u),o.removeEventListener("load",a),o.remove()},a=function(){if(o.contentWindow){var t=o.contentWindow.location.href;f.containsAuthCode(t)&&(r(),e(t))}},u=window.setTimeout((function(){r(),t("Timeout")}),n.timeout),o.style.display="none",o.addEventListener("load",a),document.body.appendChild(o),o.src=l.toString()}))]}}))}))},e.getOAuth2Tokens=function(e){return We(this,void 0,void 0,(function(){var t,n,r,o,a,u,c,s,l,d;return Ke(this,(function(p){switch(p.label){case 0:return t=i.get(e),n=t.clientId,r=t.redirectUri,o={client_id:n,code:e.authorizationCode,grant_type:"authorization_code",redirect_uri:r},e.verifier&&(o.code_verifier=e.verifier),a=f(o),u={body:a,headers:{"content-length":a.length.toString(),"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("accessToken",void 0,!1,u,e)];case 1:return c=p.sent(),[4,this.getBody(c)];case 2:if(s=p.sent(),200!==c.status)throw l="string"==typeof s?"Expected 200, received "+c.status:this.parseError(s),new Error(l);if(!(d=s).access_token)throw new Error("Access token not found in response");return[2,{accessToken:d.access_token,idToken:d.id_token,refreshToken:d.refresh_token}]}}))}))},e.getUserInfo=function(e){return We(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return[4,this.request("userInfo",void 0,!0,void 0,e)];case 1:if(200!==(t=n.sent()).status)throw new Error("Failed to get user info; received "+t.status);return[4,t.json()];case 2:return[2,n.sent()]}}))}))},e.endSession=function(e){return We(this,void 0,void 0,(function(){var t,n,r;return Ke(this,(function(o){switch(o.label){case 0:return[4,Ue.get()];case 1:return t=o.sent().idToken,n={},t&&(n.id_token_hint=t),[4,this.request("endSession",n,!0,void 0,e)];case 2:if(!Fe(r=o.sent()))throw new Error("Failed to end session; received "+r.status);return[2,r]}}))}))},e.revokeToken=function(e){return We(this,void 0,void 0,(function(){var t,n,r,o;return Ke(this,(function(a){switch(a.label){case 0:return t=i.get(e).clientId,[4,Ue.get()];case 1:return n=a.sent().accessToken,r={body:f({client_id:t,token:n}),credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("revoke",void 0,!1,r,e)];case 2:if(!Fe(o=a.sent()))throw new Error("Failed to revoke token; received "+o.status);return[2,o]}}))}))},e.request=function(e,t,n,o,u){return We(this,void 0,void 0,(function(){var c,s,l,f,d;return Ke(this,(function(p){switch(p.label){case 0:return c=i.get(u).serverConfig,s=this.getUrl(e,t,u),l=function(e){switch(e){case"accessToken":return r.ExchangeToken;case"endSession":return r.Logout;case"revoke":return r.RevokeToken;default:return r.UserInfo}},o=o||{},n?[4,Ue.get()]:[3,2];case 1:f=p.sent().accessToken,o.credentials="include",o.headers=o.headers||new Headers,o.headers.set("authorization","Bearer "+f),p.label=2;case 2:return d=h({url:new URL(s),init:o},l(e)),[4,a(fetch(d.url.toString(),d.init),c.timeout)];case 3:return[2,p.sent()]}}))}))},e.containsAuthCode=function(e){return!!e&&/code=([^&]+)/.test(e)},e.getBody=function(e){return We(this,void 0,void 0,(function(){var t;return Ke(this,(function(n){switch(n.label){case 0:return(t=e.headers.get("content-type"))&&t.indexOf("application/json")>-1?[4,e.json()]:[3,2];case 1:return[2,n.sent()];case 2:return[4,e.text()];case 3:return[2,n.sent()]}}))}))},e.parseError=function(e){if(e){if(e.error&&e.error_description)return e.error+": "+e.error_description;if(e.code&&e.message)return e.code+": "+e.message}},e.getUrl=function(e,t,n){var r=i.get(n),o=r.realmPath,a=r.serverConfig,u=s(e,o,a.paths),c=l(a.baseUrl,u);return t&&(c+="?"+f(t)),c},e}();var ze,Qe,Je=function(e){void 0===e&&(e=15);var t=-1,n=0;if(e<4||e>15)throw new Error("Invalid nonce length");return function(){var r=Math.pow(10,2)*+new Date;r===t?n++:(n=0,t=r);var o=(r+n).toString();return+o.substr(o.length-e)}},Xe=function(){return(Xe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ye=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},$e=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ze=function(){function e(){}return e.getTokens=function(e){return Ye(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,c,s,l;return $e(this,(function(f){switch(f.label){case 0:if(e&&e.forceRenew)return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,Ue.get()];case 2:return(t=f.sent())?[2,t]:[3,4];case 3:return n=f.sent(),console.error("Failed to retrieve stored tokens",n),[3,4];case 4:return r=qe.createVerifier(),o=Je()().toString(),i=Xe(Xe({},e),{responseType:Be.Code,state:o,verifier:r}),[4,Ge.getAuthorizeUrl(i)];case 5:if(a=f.sent(),d=new URL(a),p={},d.searchParams.forEach((function(e,t){return p[t]=e})),(u=p).state!==o)throw new Error("State mismatch");if(!u.code||Array.isArray(u.code))throw new Error("Failed to acquire authorization code");return c=u.code,s=Xe(Xe({},e),{authorizationCode:c,verifier:r}),[4,Ge.getOAuth2Tokens(s)];case 6:t=f.sent(),f.label=7;case 7:return f.trys.push([7,9,,10]),[4,Ue.set(t)];case 8:return f.sent(),[3,10];case 9:return l=f.sent(),console.error("Failed to store tokens",l),[3,10];case 10:return[2,t]}var d,p}))}))},e.deleteTokens=function(){return Ye(this,void 0,void 0,(function(){return $e(this,(function(e){switch(e.label){case 0:return[4,Ue.remove()];case 1:return e.sent(),[2]}}))}))},e}(),et=function(){function e(){}return e.getCurrentUser=function(){return Ge.getUserInfo()},e}(),tt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},nt=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},rt=function(){function e(){}return e.login=function(e,t){return tt(this,void 0,void 0,(function(){return nt(this,(function(n){throw console.info(e,t),new Error("FRUser.login() not implemented")}))}))},e.loginWithUI=function(e,t){return tt(this,void 0,void 0,(function(){return nt(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,e.getSession(t)];case 1:return n.sent(),[4,Ze.getTokens({forceRenew:!0})];case 2:return n.sent(),[4,et.getCurrentUser()];case 3:return[2,n.sent()];case 4:throw n.sent(),new Error("Login failed");case 5:return[2]}}))}))},e.logout=function(e){return tt(this,void 0,void 0,(function(){return nt(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,Ge.endSession(e)];case 1:return t.sent(),[4,Ge.revokeToken(e)];case 2:return t.sent(),[4,Ze.deleteTokens()];case 3:return t.sent(),[3,5];case 4:throw t.sent(),new Error("Logout failed");case 5:return[2]}}))}))},e}();function ot(e){return e||[]}function it(e){var t=new Uint8Array(e.response.clientDataJSON);return(new TextDecoder).decode(t)}function at(e){return e?e[1]:""}function ut(e){try{return e.split("}").filter((function(e){return!!e&&"]"!==e})).map((function(e){var t=function(e){var t=/new Int8Array\((.+)\)/.exec(e);if(null===t||t.length<2)return[];return JSON.parse(t[1])}(e);return{id:new Int8Array(t).buffer,type:"public-key"}}))}catch(e){throw new Error("Failed to parse credentials")}}function ct(e){if(e){if(Array.isArray(e))return e;if("string"==typeof e)return e&&"["===e[0]?JSON.parse(e):(e=e.replace(/(\w+):/g,'"$1":'),JSON.parse("["+e+"]"))}}function st(e){return e.includes("rpId")?e.replace(/rpId: "(.+)",/,"$1"):e.replace(/id: "(.+)",/,"$1")}!function(e){e.Error="ERROR",e.Unsupported="unsupported"}(ze||(ze={})),function(e){e[e.None=0]="None",e[e.Authentication=1]="Authentication",e[e.Registration=2]="Registration"}(Qe||(Qe={}));var lt=function(){return(lt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var ft=function(){return(ft=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},dt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},pt=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ht=function(){function e(){}return e.getWebAuthnStepType=function(e){var t=this.getOutcomeCallback(e),n=this.getMetadataCallback(e),r=this.getTextOutputCallback(e);return t&&n?n.getOutputValue("data").allowCredentials?Qe.Authentication:Qe.Registration:t&&r?r.getMessage().includes("allowCredentials")?Qe.Authentication:Qe.Registration:Qe.None},e.authenticate=function(e){return dt(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,c,s;return pt(this,(function(l){switch(l.label){case 0:if(t=this.getCallbacks(e),n=t.hiddenCallback,r=t.metadataCallback,o=t.textOutputCallback,!n||!r&&!o)return[3,5];i=void 0,l.label=1;case 1:return l.trys.push([1,3,,4]),a=void 0,r?(u=r.getOutputValue("data"),a=this.createAuthenticationPublicKey(u)):o&&(f=o.getMessage(),d=at(f.match(/allowCredentials:\s{0,}\[([^]+)\s{0,}]/)).trim(),p=(d.split("},")||[d]).map((function(e){var t=at(e.match(/"type":\s{0,}"([\w-]+)"/)),n=ot(f.match(/"id":\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),r=JSON.parse(n[2]);return{type:t,id:new Int8Array(r).buffer}})),h=Number(at(f.match(/timeout:\s{0,}(\d+)/))),b=ot(f.match(/challenge:\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),y=JSON.parse(b[2]),v=new Int8Array(y).buffer,g=at(f.match(/rpId:\s{0,}\[([^]+)\s{0,}]/)),a=lt({allowCredentials:p,challenge:v,timeout:h},g&&{id:g})),[4,this.getAuthenticationCredential(a)];case 2:return c=l.sent(),i=this.getAuthenticationOutcome(c),[3,4];case 3:return s=l.sent(),i=this.getErrorOutcome(s),[3,4];case 4:return n.setInputValue(i),[2,e];case 5:throw new Error("Invalid webauthn payload")}var f,d,p,h,b,y,v,g}))}))},e.register=function(e){return dt(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,c,s;return pt(this,(function(l){switch(l.label){case 0:if(t=this.getCallbacks(e),n=t.hiddenCallback,r=t.metadataCallback,o=t.textOutputCallback,!n||!r&&!o)return[3,5];i=void 0,l.label=1;case 1:return l.trys.push([1,3,,4]),a=void 0,r?(u=r.getOutputValue("data"),a=this.createRegistrationPublicKey(u)):o&&(a=function(e){var t=new TextEncoder,n=at(e.match(/attestation:\s{0,}"(\w+)"/)),r=Number(at(e.match(/timeout:\s{0,}(\d+)/))),o=at(e.match(/"userVerification":\s{0,}"(\w+)"/)),i=at(e.match(/rp:\s{0,}{([^}]+)}/)).trim(),a=at(i.match(/id:\s{0,}"([^"]*)"/)),u=at(i.match(/name:\s{0,}"([^"]*)"/)),c=at(e.match(/user:\s{0,}{([^]{0,})},/)).trim(),s=at(c.match(/id:\s{0,}Uint8Array.from\("([^"]+)"/)),l=at(c.match(/name:\s{0,}"([\d\w._-]+)"/)),f=at(c.match(/displayName:\s{0,}"([\d\w._-]+)"/)),d=ct(at(e.match(/pubKeyCredParams:\s{0,}\[([^]+) ]/)).trim());if(!d)throw new Error("Missing pubKeyCredParams");var p=ot(e.match(/challenge:\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),h=JSON.parse(p[2]);return{attestation:n,authenticatorSelection:{userVerification:o},challenge:new Int8Array(h).buffer,excludeCredentials:[],pubKeyCredParams:d,rp:{id:a,name:u},timeout:r,user:{displayName:f,id:t.encode(s),name:l}}}(o.getMessage())),[4,this.getRegistrationCredential(a)];case 2:return c=l.sent(),i=this.getRegistrationOutcome(c),[3,4];case 3:return s=l.sent(),i=this.getErrorOutcome(s),[3,4];case 4:return n.setInputValue(i),[2,e];case 5:throw new Error("Invalid webauthn payload")}}))}))},e.getCallbacks=function(e){var t=this.getOutcomeCallback(e),n=this.getMetadataCallback(e),r=this.getTextOutputCallback(e),o={hiddenCallback:t};return n?o.metadataCallback=n:r&&(o.textOutputCallback=r),o},e.getMetadataCallback=function(e){return e.getCallbacksOfType(p.MetadataCallback).find((function(e){var t=e.getOutputByName("data",void 0);return t&&t.hasOwnProperty("relyingPartyId")}))},e.getOutcomeCallback=function(e){return e.getCallbacksOfType(p.HiddenValueCallback).find((function(e){return"webAuthnOutcome"===e.getOutputByName("id","")}))},e.getTextOutputCallback=function(e){return e.getCallbacksOfType(p.TextOutputCallback).find((function(e){var t=e.getOutputByName("message",void 0);return t&&t.includes("webAuthnOutcome")}))},e.getAuthenticationCredential=function(e){return dt(this,void 0,void 0,(function(){return pt(this,(function(t){switch(t.label){case 0:return[4,navigator.credentials.get({publicKey:e})];case 1:return[2,t.sent()]}}))}))},e.getAuthenticationOutcome=function(e){if(!window.PublicKeyCredential)return ze.Unsupported;try{if(null===e)throw new Error("No credential provided");var t=it(e),n=e.response;return t+"::"+new Int8Array(n.authenticatorData).toString()+"::"+new Int8Array(n.signature).toString()+"::"+e.id}catch(e){return this.getErrorOutcome(e)}},e.getRegistrationCredential=function(e){return dt(this,void 0,void 0,(function(){var t,n;return pt(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,navigator.credentials.create({publicKey:e})];case 1:return t=r.sent(),[3,3];case 2:throw n=r.sent(),new Error(n.message);case 3:return[2,t]}}))}))},e.getRegistrationOutcome=function(e){if(!window.PublicKeyCredential)return ze.Unsupported;try{if(null===e)throw new Error("No credential provided");var t=it(e),n=e.response;return t+"::"+new Int8Array(n.attestationObject).toString()+"::"+e.id}catch(e){return this.getErrorOutcome(e)}},e.createAuthenticationPublicKey=function(e){var t=e.allowCredentials,n=e.challenge,r=e.relyingPartyId,o=e.timeout,i=st(r);return ft({allowCredentials:ut(t),challenge:Uint8Array.from(atob(n),(function(e){return e.charCodeAt(0)})).buffer,timeout:o},i&&{rpId:i})},e.createRegistrationPublicKey=function(e){var t=ct(e.pubKeyCredParams);if(!t)throw new Error("Missing pubKeyCredParams");var n=e.attestationPreference,r=e.authenticatorSelection,o=e.challenge,i=e.relyingPartyId,a=e.relyingPartyName,u=e.timeout,c=e.userId,s=e.userName,l=st(i),f=ft({name:a},l&&{id:l});return{attestation:n,authenticatorSelection:JSON.parse(r),challenge:Uint8Array.from(atob(o),(function(e){return e.charCodeAt(0)})).buffer,pubKeyCredParams:t,rp:f,timeout:u,user:{displayName:s,id:Int8Array.from(c.split("").map((function(e){return e.charCodeAt(0)}))),name:s}}},e.getErrorOutcome=function(e){var t=e.name?e.name+":":"";return ze.Error+"::"+t+e.message},e}(),bt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},yt=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};function vt(e){return bt(this,void 0,void 0,(function(){return yt(this,(function(t){switch(t.label){case 0:return[4,e.clone().json()];case 1:return[2,!!t.sent().advices]}}))}))}function gt(e){var t=new URL(e).searchParams.get("authIndexValue")||"",n=new DOMParser,r=decodeURIComponent(t),o=n.parseFromString(r,"application/xml").querySelector("Value");return o?o.innerHTML:""}function mt(e){return bt(this,void 0,void 0,(function(){return yt(this,(function(t){switch(t.label){case 0:return[4,e.clone().json()];case 1:return[2,!!t.sent().callbacks]}}))}))}function wt(e){return bt(this,void 0,void 0,(function(){return yt(this,(function(t){switch(t.label){case 0:return[4,e.json()];case 1:return[2,t.sent()]}}))}))}var Ct=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},_t=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ct(t,e),t.request=function(e){return kt(this,void 0,void 0,(function(){var t,n,o,a,u,c,d,p,b,y,v,g,m,w,C,k;return _t(this,(function(_){switch(_.label){case 0:return[4,this._request(e,!1)];case 1:return t=_.sent(),o=!1,function(e,t){return"function"==typeof t?t(e):401===e.status}(t,e.requiresNewToken)?[4,this._request(e,!0)]:[3,3];case 2:t=_.sent(),_.label=3;case 3:return e.authorization&&e.authorization.handleStep?t.redirected&&function(e){return(e.headers.get("Content-Type")||"").includes("html")&&e.url.includes("composite_advice")}(t)?(o=!0,n=function(e){var t={};return e.url.includes("AuthenticateToServiceConditionAdvice")?t.AuthenticateToServiceConditionAdvice=[gt(e.url)]:t.TransactionConditionAdvice=[gt(e.url)],{resource:"",actions:{},attributes:{},advices:t,ttl:0}}(t),[3,7]):[3,4]:[3,18];case 4:return[4,vt(t)];case 5:return _.sent()?[4,wt(t)]:[3,7];case 6:n=_.sent(),_.label=7;case 7:return n&&n.advices?(a=i.get(e.authorization.config),u=a.realmPath,c=a.serverConfig,d=function(e,t,n,r,o){var i=e.advices&&e.advices.AuthenticateToServiceConditionAdvice,a=e.advices&&e.advices.TransactionConditionAdvice,u="",c="";i?(u=i.reduce((function(e,t){return e=""+t+(e?" "+e:e)}),""),c="AuthenticateToServiceConditionAdvice"):a&&(u=a.reduce((function(e,t){return e=""+t+(e?" "+e:e)}),""),c="TransactionConditionAdvice");var d="<Advices><AttributeValuePair>"+('<Attribute name="'+c+'"/>')+("<Value>"+u+"</Value>")+"</AttributeValuePair></Advices>";return{init:{method:"POST",credentials:"include",headers:{"Accept-API-Version":"resource=2.0, protocol=1.0"}},timeout:n,url:l(t,s("authenticate",r,o)+"?"+f({authIndexType:"composite_advice",authIndexValue:d}))}}(n,c.baseUrl,e.timeout,u,c.paths),p=new URL(d.url),b=p.searchParams.get("authIndexType"),y=p.searchParams.get("authIndexValue"),v=h({url:new URL(d.url),init:d.init},r.StartAuthenticate,{type:b,tree:y}),g=v.url,m=v.init,d.url=g.toString(),d.init=m,[4,this._request(d,!1)]):[3,18];case 8:return[4,mt(w=_.sent())];case 9:if(!_.sent())throw new Error('Error: Initial response from auth server not a "step".');if(!((O=n).advices&&O.advices.AuthenticateToServiceConditionAdvice?Array.isArray(O.advices.AuthenticateToServiceConditionAdvice)&&O.advices.AuthenticateToServiceConditionAdvice.length>0:O.advices&&O.advices.TransactionConditionAdvice&&Array.isArray(O.advices.TransactionConditionAdvice)&&O.advices.TransactionConditionAdvice.length>0))throw new Error("Error: Transactional or Service Advice is empty.");_.label=10;case 10:return _.trys.push([10,17,,18]),[4,this.stepIterator(w,e.authorization.handleStep,b,y)];case 11:_.sent(),C=void 0,_.label=12;case 12:return _.trys.push([12,14,,15]),[4,Ue.get()];case 13:return C=_.sent(),[3,15];case 14:return _.sent(),[3,15];case 15:return o?e.url=function(e,t,n){var r=new URL(e);if(t.TransactionConditionAdvice){var o=t.TransactionConditionAdvice[0];r.searchParams.append("_txid",o)}return n&&n.idToken&&r.searchParams.append("_idtoken",n.idToken),r.toString()}(e.url,n.advices,C):e.init.headers=function(e,t,n){var r=new Headers(e.headers);return t.AuthenticateToServiceConditionAdvice?r.set("x-tree",t.AuthenticateToServiceConditionAdvice[0]):t.TransactionConditionAdvice&&r.set("x-txid",t.TransactionConditionAdvice[0]),n&&n.idToken&&r.set("x-idtoken",n.idToken),r}(e.init,n.advices,C),[4,this._request(e,!1)];case 16:return t=_.sent(),[3,18];case 17:throw k=_.sent(),new Error(k);case 18:return[2,t]}var O}))}))},t.setAuthHeaders=function(e,t){return kt(this,void 0,void 0,(function(){var n;return _t(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Ue.get()];case 1:return n=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return n&&n.accessToken?[4,Ze.getTokens({forceRenew:t})]:[3,5];case 4:n=r.sent(),e.set("Authorization","Bearer "+n.accessToken),r.label=5;case 5:return[2,e]}}))}))},t.stepIterator=function(e,t,n,r){return kt(this,void 0,void 0,(function(){var o,i,a=this;return _t(this,(function(u){switch(u.label){case 0:return[4,e.json()];case 1:return o=u.sent(),i=new se(o),[2,new Promise((function(e,o){return kt(a,void 0,void 0,(function(){return _t(this,(function(a){return function i(a){return kt(this,void 0,void 0,(function(){var u,c;return _t(this,(function(s){switch(s.label){case 0:return[4,t(a)];case 1:return u=s.sent(),[4,de.next(u,{type:n,tree:r})];case 2:return(c=s.sent()).type===O.LoginSuccess?e():c.type===O.LoginFailure?o("Authentication tree failure."):i(c),[2]}}))}))}(i),[2]}))}))}))]}}))}))},t._request=function(e,t){return kt(this,void 0,void 0,(function(){var n,r,o,i,u;return _t(this,(function(c){switch(c.label){case 0:return n=e.url,r=e.init,o=e.timeout,i=new Headers(r.headers||{}),e.bypassAuthentication?[3,2]:[4,this.setAuthHeaders(i,t)];case 1:i=c.sent(),c.label=2;case 2:r.headers=i,c.label=3;case 3:return c.trys.push([3,5,,7]),[4,a(fetch(n,r),o)];case 4:return u=c.sent(),[3,7];case 5:return c.sent(),[4,a(fetch(n,{method:"GET"}),o)];case 6:return u=c.sent(),[3,7];case 7:return[2,u]}}))}))},t}(C),Pt=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},St=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Tt=function(){function e(){}return e.logout=function(e){return Pt(this,void 0,void 0,(function(){var t,n,o,u,c,f,d,p;return St(this,(function(b){switch(b.label){case 0:return t=i.get(e),n=t.realmPath,o=t.serverConfig,u={credentials:"include",headers:{"accept-api-version":"protocol=1.0,resource=2.0","x-requested-with":"forgerock-sdk"},method:"POST"},c=s("sessions",n,o.paths)+"?_action=logout",f=l(o.baseUrl,c),d=h({url:new URL(f),init:u},r.Logout),[4,a(fetch(d.url.toString(),d.init),o.timeout)];case 1:if(!Fe(p=b.sent()))throw new Error("Failed to log out; received "+p.status);return[2,p]}}))}))},e}(),At=function(){var e=this;this.promise=new Promise((function(t,n){e.reject=n,e.resolve=t}))},Et=function(){function e(e){void 0===e&&(e=!1),this.storage=e?window.localStorage:window.sessionStorage}return e.prototype.get=function(e){var t=this.storage.getItem(e);if(t)return JSON.parse(t)},e.prototype.set=function(e,t){this.storage.setItem(e,JSON.stringify(t))},e.prototype.remove=function(e){this.storage.removeItem(e)},e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.el=void 0,t.el=function(e,t){var n=document.createElement(e);return t&&(n.className=t),n}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(3)),i=function(e,t){var n=this;this.target=e,this.step=t,this.completeStep=function(){return n.render(),n.getRefs(),n.bind(),n.ready(),n.deferred.promise},this.bind=function(){},this.getRefs=function(){},this.getTemplate=function(){return""},this.ready=function(){},this.render=function(){n.target.innerHTML=n.getTemplate()},this.findElement=function(e,t){void 0===t&&(t=!0);var r=n.target.querySelector(e);if(t&&!r)throw new Error('Element "'+e+'" not found');return r},this.deferred=new o.default};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this;this.promise=new Promise((function(t,n){e.reject=n,e.resolve=t}))};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=this;this.button=e,this.enable=function(){t.button.innerHTML=t.text,t.button.disabled=!1},this.disable=function(e){t.button.innerHTML=e||"Verifying...",t.button.disabled=!0},this.bind=function(e){t.button.addEventListener("click",e)},this.unbind=function(e){t.button.removeEventListener("click",e)},this.text=e.innerHTML};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderErrors=void 0;var r=n(0),o=n(1);t.renderErrors=function(e,t){if(e&&0!==e.length){var n=e.map((function(e){return r.FRPolicy.parsePolicyRequirement(t,e)})),i=o.el("ul","fr-error");return n.forEach((function(e){var t=o.el("li");t.innerHTML=e,i.appendChild(t)})),i}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ExpressStage=void 0,function(e){e.DeviceAuthentication="DeviceAuthentication",e.DeviceRegistration="DeviceRegistration",e.DeviceRegistrationChoice="DeviceRegistrationChoice",e.LoginSuccess="LoginSuccess",e.OneTimePasswordEmail="OneTimePasswordEmail",e.OneTimePasswordSMS="OneTimePasswordSMS",e.Password="Password",e.PasswordlessChoice="PasswordlessChoice",e.RegistrationSuccess="RegistrationSuccess",e.RegistrationUserInfo="RegistrationUserInfo",e.SecondFactorChoice="SecondFactorChoice",e.Username="Username",e.UsernamePassword="UsernamePassword",e.UserPassword="UserPassword"}(r||(r={})),t.ExpressStage=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=this;this.input=e,this.bind=function(){t.toggler.addEventListener("click",t.onToggle)},this.unbind=function(){t.toggler.removeEventListener("click",t.onToggle)},this.onToggle=function(){t.input.type="text"===t.input.type?"password":"text",t.togglerIcon.innerText="text"===t.input.type?"visibility":"visibility_off"},this.group=e.closest(".form-group"),this.toggler=this.group.querySelector("button"),this.togglerIcon=this.toggler.querySelector("i")};t.default=r},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasicStepHandler=void 0;var o=n(0),i=n(9),a=r(n(20));t.BasicStepHandler=a.default;var u=r(n(23));t.default=function(e,t,n){if(!t)throw new Error("Cannot create handler; no step specified");var r=o.FRWebAuthn.getWebAuthnStepType(t);if(r!==o.WebAuthnStepType.None){var c=r===o.WebAuthnStepType.Authentication?i.WebAuthnMode.Authentication:i.WebAuthnMode.Registration;return new u.default(e,t,c)}return new a.default(e,t,n)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.WebAuthnMode=void 0,function(e){e.Authentication="authentication",e.Registration="registration"}(r||(r={})),t.WebAuthnMode=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(5),i=function(e,t,n){var i=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){return i.input.removeEventListener("change",i.onInput)},this.focus=function(){return i.input.focus()},this.render=function(){var e=r.el("div","fr-callback-"+i.index+" form-check mb-3");i.input=r.el("input","form-check-input"),i.input.checked=i.callback.getInputValue(),i.input.id="fr-callback-"+i.index,i.input.type="checkbox",i.input.addEventListener("change",i.onInput),e.appendChild(i.input);var t=i.callback.getPrompt();if(t){var n=r.el("label","form-check-label");n.innerHTML=t,n.htmlFor=i.input.id,e.appendChild(n)}var a=o.renderErrors(i.callback.getFailedPolicies(),t);return a&&e.appendChild(a),e},this.onInput=function(){i.callback.setValue(i.input.checked),i.onChange(i)}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){return o.input.removeEventListener("change",o.onInput)},this.focus=function(){return o.input.focus()},this.isValid=function(){return o.input&&o.input.value.length>0},this.render=function(){var e=o.callback.getInputValue(),t=r.el("div","fr-callback-"+o.index+" form-group"),n="fr-callback-"+o.index,i=o.callback.getPrompt();if(i){var a=r.el("label");a.innerHTML=i,a.htmlFor=n,t.appendChild(a)}return o.input=r.el("select","form-control"),o.input.id=n,o.input.addEventListener("change",o.onInput),o.callback.getChoices().forEach((function(t,n){var i=r.el("option");i.value=n.toString(),i.text=t,i.selected=n===e,o.input.appendChild(i)})),t.appendChild(o.input),t},this.onInput=function(){o.callback.setChoiceIndex(Number(o.input.value)),o.onChange(o)}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){o.buttons.forEach((function(e){return e.element.removeEventListener("click",e.handler)})),o.buttons=[]},this.focus=function(){return o.buttons[0].element.focus()},this.render=function(){var e=r.el("div","fr-callback-"+o.index+" form-group"),t=o.callback.getPrompt();if(t){var n=r.el("label");n.innerHTML=t,e.appendChild(n)}return o.buttons=o.callback.getOptions().map((function(e,t){var n=function(){return o.onInput(t)},i=r.el("button");return i.className="btn btn-primary mt-3",i.innerHTML=e,i.addEventListener("click",n),{element:i,handler:n}})),o.buttons.forEach((function(t){return e.appendChild(t.element)})),e},this.onInput=function(e){o.callback.setInputValue(e),o.onChange(o)}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(5),i=function(e,t,n){var i=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){return i.input.removeEventListener("keyup",i.onInput)},this.focus=function(){return i.input.focus()},this.isValid=function(){return i.input&&i.input.value.length>0},this.render=function(){var e=r.el("div","fr-callback-"+i.index+" form-group"),t=r.el("div","form-label-group");e.appendChild(t),i.input=r.el("input","form-control"),i.input.id="fr-callback-"+i.index,i.input.type="text",i.input.value=i.callback.getInputValue(),i.input.addEventListener("keyup",i.onInput),t.appendChild(i.input);var n=i.callback.getOutputByName("prompt","");if(n){i.input.placeholder=n;var a=r.el("label");a.innerHTML=n,a.htmlFor=i.input.id,t.appendChild(a)}var u=i.callback.getOutputByName("failedPolicies",[]);if(u.length>0){var c=o.renderErrors(u,n);c&&e.appendChild(c)}return e},this.onInput=function(){i.callback.setInputValue(i.input.value),i.onChange(i)}};t.default=i},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i="Answer",a="Custom Question",u=function(e,t,n,u){var c=this;this.callback=e,this.index=t,this.kbaIndex=n,this.onChange=u,this.destroy=function(){c.select.removeEventListener("change",c.onQuestionChange),c.custom.removeEventListener("keyup",c.onInput),c.answer.removeEventListener("keyup",c.onInput)},this.focus=function(){return c.select.focus()},this.isValid=function(){if(!c.select||!c.custom||!c.answer)return!1;var e=!c.isCustomQuestion()||c.custom.value.length>0,t=c.answer.value.length>0;return e&&t},this.render=function(){var e=o.el("div","fr-callback-"+c.index+" form-group");if(0===c.kbaIndex){var t=o.el("p");t.innerHTML=c.callback.getPrompt(),e.appendChild(t)}var n=c.callback.getPredefinedQuestions(),u=c.callback.getInputValue(0)||n[c.kbaIndex],s=!n.includes(u),l=r(n,[a]),f=l.indexOf(s?a:u),d=o.el("div","mb-1");c.select=o.el("select","form-control custom-select"),c.select.required=!0,l.forEach((function(e,t){var n=c.createOption(e,t===f);c.select.appendChild(n)})),c.select.addEventListener("change",c.onQuestionChange),d.appendChild(c.select),e.appendChild(d),c.customWrap=o.el("div","form-label-group fr-kba-custom-wrap mb-1 d-none"),c.custom=o.el("input","form-control fr-kba-custom"),c.custom.id="fr-callback-"+c.index+"-custom",c.custom.type="text",c.custom.value=s?u:"",c.custom.addEventListener("keyup",c.onInput),c.customWrap.appendChild(c.custom);var p=o.el("label");p.htmlFor=c.custom.id,p.innerHTML=a,c.customWrap.appendChild(p),e.appendChild(c.customWrap);var h=o.el("div","form-label-group mb-0");c.answer=o.el("input","form-control fr-kba-answer"),c.answer.id="fr-callback-"+c.index+"-answer",c.answer.placeholder=i,c.answer.type="text",c.answer.value=c.callback.getInputValue(1),c.answer.addEventListener("keyup",c.onInput),h.appendChild(c.answer);var b=o.el("label");return b.htmlFor=c.answer.id,b.innerHTML=i,h.appendChild(b),e.appendChild(h),c.setView(),e},this.createOption=function(e,t){var n=o.el("option");return n.value=e,n.text=e,n.selected=t,n},this.isCustomQuestion=function(){return c.select.value===a},this.onQuestionChange=function(){c.setView(),c.onInput()},this.setView=function(){c.isCustomQuestion()?c.customWrap.classList.remove("d-none"):c.customWrap.classList.add("d-none")},this.onInput=function(){c.isCustomQuestion()?c.callback.setQuestion(c.custom.value):c.callback.setQuestion(c.select.value),c.callback.setAnswer(c.answer.value),c.onChange(c)}};t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(5),i=function(e,t,n){var i=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){i.input.removeEventListener("keyup",i.onInput),i.toggle.removeEventListener("click",i.toggleView)},this.focus=function(){return i.input.focus()},this.isValid=function(){return i.input&&i.input.value.length>0},this.render=function(){var e=r.el("div","fr-callback-"+i.index+" form-group"),t=r.el("div","form-label-group form-label-group-password"),n=r.el("div","form-label-group-input"),a=r.el("div","input-group-append");t.appendChild(n),t.appendChild(a),e.appendChild(t),i.input=r.el("input","form-control"),i.input.id="fr-callback-"+i.index,i.input.addEventListener("keyup",i.onInput),n.appendChild(i.input);var u=i.callback.getPrompt();if(u){i.input.placeholder=u;var c=r.el("label");c.innerHTML=u,c.htmlFor=i.input.id,n.appendChild(c)}i.toggle=r.el("button","btn btn-outline-secondary"),i.toggle.type="button",i.toggle.addEventListener("click",i.toggleView),i.toggleIcon=r.el("i","material-icons material-icons-outlined"),i.toggle.appendChild(i.toggleIcon),a.appendChild(i.toggle);var s=o.renderErrors(i.callback.getFailedPolicies(),u);return s&&e.appendChild(s),i.setView(!1),e},this.setView=function(e){i.input.type=e?"text":"password",i.toggleIcon.innerHTML=e?"visibility_off":"visibility"},this.toggleView=function(){i.setView("password"===i.input.type)},this.onInput=function(){i.callback.setPassword(i.input.value),i.onChange(i)}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.render=function(){var e=r.el("div","fr-callback-"+o.index+" form-group");return e.innerHTML=o.callback.getMessage(),e},this.onInjected=function(){var e=o.callback.getWaitTime();window.setTimeout((function(){return o.onChange(o)}),e)}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.result="",this.isValid=function(){return o.result.length>0},this.render=function(){var e=r.el("div","fr-callback-"+o.index+" form-group");return e.appendChild(o.container),e},this.onInjected=function(){if(!window.grecaptcha||"function"!=typeof window.grecaptcha.render)return console.error("reCAPTCHA is not present");window.grecaptcha.render(o.container,{callback:function(e){o.setResult(e)},"expired-callback":function(){o.setResult("")},sitekey:o.callback.getSiteKey()})},this.setResult=function(e){o.result=e,o.callback.setResult(e),o.onChange(o)},this.container=r.el("div","g-recaptcha")};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){return o.input.removeEventListener("change",o.onInput)},this.focus=function(){return o.input.focus()},this.isValid=function(){return o.input&&o.input.checked},this.render=function(){var e=r.el("div","fr-callback-"+o.index+" form-group"),t=r.el("p");t.innerHTML=o.callback.getTerms(),e.appendChild(t);var n=r.el("div","form-check mb-3");e.appendChild(n),o.input=r.el("input","form-check-input"),o.input.checked=o.callback.getInputValue(),o.input.id="fr-callback-"+o.index,o.input.type="checkbox",o.input.addEventListener("change",o.onInput),n.appendChild(o.input);var i=r.el("label","form-check-label");return i.innerHTML="I have read and agree to the terms and conditions",i.htmlFor=o.input.id,n.appendChild(i),e},this.onInput=function(){o.callback.setAccepted(o.input.checked),o.onChange(o)}};t.default=o},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebAuthnStepType=t.WebAuthnOutcome=t.ValidatedCreateUsernameCallback=t.ValidatedCreatePasswordCallback=t.UserManager=t.TokenStorage=t.TokenManager=t.TextOutputCallback=t.TermsAndConditionsCallbackRenderer=t.TermsAndConditionsCallback=t.StepType=t.SessionManager=t.ReCaptchaCallbackRenderer=t.ReCaptchaCallback=t.PollingWaitCallbackRenderer=t.PollingWaitCallback=t.PolicyKey=t.PKCE=t.PasswordCallbackRenderer=t.PasswordCallback=t.OAuth2Client=t.NameCallback=t.MetadataCallback=t.LocalStorage=t.KbaCreateCallbackRenderer=t.KbaCreateCallback=t.HttpClient=t.HiddenValueCallback=t.GenericCallbackRenderer=t.FRWebAuthn=t.FRUser=t.FRUI=t.FRStepHandlerBase=t.FRStep=t.FRPolicy=t.FRLoginSuccess=t.FRLoginFailure=t.FRCallback=t.FRAuth=t.ErrorCode=t.Dispatcher=t.ConfirmationCallbackRenderer=t.ConfirmationCallback=t.Config=t.ChoiceCallbackRenderer=t.ChoiceCallback=t.CallbackType=t.BooleanAttributeCallbackRenderer=t.BasicStepHandler=t.Auth=t.AttributeInputCallback=t.expressStepHandlerFactory=t.defaultMessageCreator=t.basicStepHandlerFactory=void 0;var u=n(0);Object.defineProperty(t,"AttributeInputCallback",{enumerable:!0,get:function(){return u.AttributeInputCallback}}),Object.defineProperty(t,"Auth",{enumerable:!0,get:function(){return u.Auth}}),Object.defineProperty(t,"CallbackType",{enumerable:!0,get:function(){return u.CallbackType}}),Object.defineProperty(t,"ChoiceCallback",{enumerable:!0,get:function(){return u.ChoiceCallback}}),Object.defineProperty(t,"Config",{enumerable:!0,get:function(){return u.Config}}),Object.defineProperty(t,"ConfirmationCallback",{enumerable:!0,get:function(){return u.ConfirmationCallback}}),Object.defineProperty(t,"defaultMessageCreator",{enumerable:!0,get:function(){return u.defaultMessageCreator}}),Object.defineProperty(t,"Dispatcher",{enumerable:!0,get:function(){return u.Dispatcher}}),Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return u.ErrorCode}}),Object.defineProperty(t,"FRAuth",{enumerable:!0,get:function(){return u.FRAuth}}),Object.defineProperty(t,"FRCallback",{enumerable:!0,get:function(){return u.FRCallback}}),Object.defineProperty(t,"FRLoginFailure",{enumerable:!0,get:function(){return u.FRLoginFailure}}),Object.defineProperty(t,"FRLoginSuccess",{enumerable:!0,get:function(){return u.FRLoginSuccess}}),Object.defineProperty(t,"FRPolicy",{enumerable:!0,get:function(){return u.FRPolicy}}),Object.defineProperty(t,"FRStep",{enumerable:!0,get:function(){return u.FRStep}}),Object.defineProperty(t,"FRUser",{enumerable:!0,get:function(){return u.FRUser}}),Object.defineProperty(t,"FRWebAuthn",{enumerable:!0,get:function(){return u.FRWebAuthn}}),Object.defineProperty(t,"HiddenValueCallback",{enumerable:!0,get:function(){return u.HiddenValueCallback}}),Object.defineProperty(t,"HttpClient",{enumerable:!0,get:function(){return u.HttpClient}}),Object.defineProperty(t,"KbaCreateCallback",{enumerable:!0,get:function(){return u.KbaCreateCallback}}),Object.defineProperty(t,"LocalStorage",{enumerable:!0,get:function(){return u.LocalStorage}}),Object.defineProperty(t,"MetadataCallback",{enumerable:!0,get:function(){return u.MetadataCallback}}),Object.defineProperty(t,"NameCallback",{enumerable:!0,get:function(){return u.NameCallback}}),Object.defineProperty(t,"OAuth2Client",{enumerable:!0,get:function(){return u.OAuth2Client}}),Object.defineProperty(t,"PasswordCallback",{enumerable:!0,get:function(){return u.PasswordCallback}}),Object.defineProperty(t,"PKCE",{enumerable:!0,get:function(){return u.PKCE}}),Object.defineProperty(t,"PolicyKey",{enumerable:!0,get:function(){return u.PolicyKey}}),Object.defineProperty(t,"PollingWaitCallback",{enumerable:!0,get:function(){return u.PollingWaitCallback}}),Object.defineProperty(t,"ReCaptchaCallback",{enumerable:!0,get:function(){return u.ReCaptchaCallback}}),Object.defineProperty(t,"SessionManager",{enumerable:!0,get:function(){return u.SessionManager}}),Object.defineProperty(t,"StepType",{enumerable:!0,get:function(){return u.StepType}}),Object.defineProperty(t,"TermsAndConditionsCallback",{enumerable:!0,get:function(){return u.TermsAndConditionsCallback}}),Object.defineProperty(t,"TextOutputCallback",{enumerable:!0,get:function(){return u.TextOutputCallback}}),Object.defineProperty(t,"TokenManager",{enumerable:!0,get:function(){return u.TokenManager}}),Object.defineProperty(t,"TokenStorage",{enumerable:!0,get:function(){return u.TokenStorage}}),Object.defineProperty(t,"UserManager",{enumerable:!0,get:function(){return u.UserManager}}),Object.defineProperty(t,"ValidatedCreatePasswordCallback",{enumerable:!0,get:function(){return u.ValidatedCreatePasswordCallback}}),Object.defineProperty(t,"ValidatedCreateUsernameCallback",{enumerable:!0,get:function(){return u.ValidatedCreateUsernameCallback}}),Object.defineProperty(t,"WebAuthnOutcome",{enumerable:!0,get:function(){return u.WebAuthnOutcome}}),Object.defineProperty(t,"WebAuthnStepType",{enumerable:!0,get:function(){return u.WebAuthnStepType}});var c=i(n(8));t.basicStepHandlerFactory=c.default,Object.defineProperty(t,"BasicStepHandler",{enumerable:!0,get:function(){return c.BasicStepHandler}});var s=a(n(10));t.BooleanAttributeCallbackRenderer=s.default;var l=a(n(11));t.ChoiceCallbackRenderer=l.default;var f=a(n(12));t.ConfirmationCallbackRenderer=f.default;var d=a(n(13));t.GenericCallbackRenderer=d.default;var p=a(n(14));t.KbaCreateCallbackRenderer=p.default;var h=a(n(15));t.PasswordCallbackRenderer=h.default;var b=a(n(16));t.PollingWaitCallbackRenderer=b.default;var y=a(n(17));t.ReCaptchaCallbackRenderer=y.default;var v=a(n(18));t.TermsAndConditionsCallbackRenderer=v.default;var g=a(n(25));t.expressStepHandlerFactory=g.default;var m=a(n(2));t.FRStepHandlerBase=m.default;var w=a(n(45));t.FRUI=w.default},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(n(3)),a=n(1),u=r(n(10)),c=r(n(11)),s=r(n(12)),l=r(n(13)),f=r(n(14)),d=r(n(15)),p=r(n(16)),h=r(n(17)),b=r(n(18)),y=r(n(21)),v=r(n(22)),g=function(e,t,n){var r=this;this.target=e,this.step=t,this.rendererFactory=n,this.callbacksThatDontRequireSubmitButton=[o.CallbackType.ConfirmationCallback,o.CallbackType.PollingWaitCallback,"RedirectCallback"],this.completeStep=function(){r.target.innerHTML="",r.container=a.el("div"),r.container.innerHTML=v.default;var e=r.container.querySelector(".fr-form"),t=r.container.querySelector(".fr-buttons");if(!e||!t)throw new Error("Required form targets not found in basic handler view");r.setHeader(),r.renderers=r.createRenderers(),r.renderers.forEach((function(t){e.appendChild(t.render())})),r.target.appendChild(r.container);var n=r.renderers.find((function(e){return!!e.focus}));return void 0!==n&&n.focus(),r.renderers.filter((function(e){return!!e.onInjected})).forEach((function(e){return e.onInjected&&e.onInjected()})),r.requiresSubmitButton()&&(r.submit=r.createSubmitButton(),t.appendChild(r.submit)),r.deferred.promise},this.setHeader=function(){var e=r.container.querySelector("h1");e&&(e.innerHTML=r.step.getHeader()||"")},this.createRenderers=function(){return r.step.callbacks.map(r.createRenderer)},this.createRenderer=function(e,t){if(r.rendererFactory){var n=r.rendererFactory(e,t,r.step,r.onChange);if(n)return n}switch(e.getType()){case o.CallbackType.BooleanAttributeInputCallback:var i=e;return new u.default(i,t,r.onChange);case o.CallbackType.ChoiceCallback:var a=e;return new c.default(a,t,r.onChange);case o.CallbackType.ConfirmationCallback:return new s.default(e,t,r.onChange);case o.CallbackType.PasswordCallback:return new d.default(e,t,r.onChange);case o.CallbackType.ValidatedCreatePasswordCallback:var v=e;return new d.default(v,t,r.onChange);case o.CallbackType.PollingWaitCallback:return new p.default(e,t,r.onChange);case o.CallbackType.ReCaptchaCallback:return new h.default(e,t,r.onChange);case o.CallbackType.TermsAndConditionsCallback:var g=e;return new b.default(g,t,r.onChange);case o.CallbackType.TextOutputCallback:return new y.default(e,t);case o.CallbackType.KbaCreateCallback:var m=e,w=r.step.getCallbacksOfType(o.CallbackType.KbaCreateCallback).filter((function(e){return e.getPrompt()===m.getPrompt()})).indexOf(m);return new f.default(m,t,w,r.onChange);default:return new l.default(e,t,r.onChange)}},this.onChange=function(){var e=r.isValid();r.setSubmitButton(e),!r.submit&&e&&r.resolve()},this.requiresSubmitButton=function(){return 0===r.step.callbacks.filter((function(e){return r.callbacksThatDontRequireSubmitButton.includes(e.getType())})).length},this.createSubmitButton=function(){var e=a.el("button","btn btn-primary");return e.disabled=!r.isValid(),e.id="fr-submit",e.innerText="Next",e.addEventListener("click",r.resolve),e},this.isValid=function(){return!r.renderers.some((function(e){return void 0!==e.isValid&&!e.isValid()}))},this.setSubmitButton=function(e){r.submit&&(r.submit.disabled=void 0!==e?!e:!r.isValid())},this.resolve=function(){r.renderers.filter((function(e){return!!e.destroy})).forEach((function(e){return e.destroy()})),r.submit&&(r.submit.disabled=!0,r.submit.removeEventListener("click",r.resolve)),r.deferred.resolve(r.step)},this.container=a.el("div"),this.container.innerHTML=v.default,this.deferred=new i.default};t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t){var n=this;this.callback=e,this.index=t,this.render=function(){var e=r.el("div","fr-callback-"+n.index+" form-group"),t=r.el("p");return t.innerHTML=n.callback.getMessage(),e.appendChild(t),e}};t.default=o},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1></h1>\n    </header>\n    <section class="fr-form">\n    </section>\n    <div class="fr-buttons"></div>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(3)),c=n(9),s=i(n(24)),l=function(e,t,n){var i=this;this.target=e,this.step=t,this.mode=n,this.completeStep=function(){return r(i,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:switch(this.mode){case c.WebAuthnMode.Authentication:return[3,1];case c.WebAuthnMode.Registration:return[3,3]}return[3,5];case 1:return this.message.innerHTML="Please authenticate using your device...",[4,a.FRWebAuthn.authenticate(this.step)];case 2:return e.sent(),this.deferred.resolve(this.step),[3,6];case 3:return this.message.innerHTML="Please register your device...",[4,a.FRWebAuthn.register(this.step)];case 4:return e.sent(),this.deferred.resolve(this.step),[3,6];case 5:throw new Error('Invalid WebAuthn mode "'+this.mode+'"');case 6:return[2,this.deferred.promise]}}))}))},this.target.innerHTML=s.default;var l=this.target.querySelector(".fr-message");if(!l)throw new Error("Required targets not found in webauthn handler view");this.message=l,this.deferred=new u.default};t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step">\n  <section class="fr-main">\n    <div class="fr-message">\n      Waiting for device...\n    </div>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),i=r(n(26)),a=r(n(31)),u=r(n(33)),c=r(n(35)),s=r(n(39)),l=r(n(41)),f=r(n(43));t.default=function(e,t){if(!t)throw new Error("Cannot create handler; no step specified");var n=t.getStage();switch(n){case o.ExpressStage.DeviceRegistrationChoice:case o.ExpressStage.PasswordlessChoice:case o.ExpressStage.SecondFactorChoice:return new i.default(e,t);case o.ExpressStage.OneTimePasswordEmail:case o.ExpressStage.OneTimePasswordSMS:case o.ExpressStage.UserPassword:return new c.default(e,t);case o.ExpressStage.Username:return new l.default(e,t);case o.ExpressStage.UsernamePassword:return new f.default(e,t);case o.ExpressStage.DeviceAuthentication:return new a.default(e,t);case o.ExpressStage.DeviceRegistration:return new u.default(e,t);case o.ExpressStage.RegistrationUserInfo:return new s.default(e,t);default:throw new Error('Unsupported stage "'+n+'"')}}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(2)),c=n(27),s=n(6),l=i(n(28)),f=i(n(29)),d=i(n(30)),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=void 0,t.bind=function(){t.target.addEventListener("click",t.onClick)},t.unbind=function(){t.target.removeEventListener("click",t.onClick)},t.getTemplate=function(){switch(t.step.getStage()){case s.ExpressStage.DeviceRegistrationChoice:return l.default;case s.ExpressStage.PasswordlessChoice:return f.default;case s.ExpressStage.SecondFactorChoice:return t.renderSecondFactorChoiceTemplate(d.default)}throw new Error('Unsupported choice type "'+t.step.getStage()+'"')},t.onClick=function(e){var n=e.srcElement.getAttribute("data-choice");if(null!==n){var r=Number(n);t.getCallback().setChoiceIndex(r),t.unbind(),t.deferred.resolve(t.step)}},t.renderSecondFactorChoiceTemplate=function(e){var n=t.getCallback().getChoices(),r=t.updateChoiceStrings(n),o=t.getChoicesMarkup(r),i=t.getSubtitleMarkup(r.length);return c.replaceTokens(e,{CHOICES:o,SUBTITLE:i})},t.getCallback=function(){return t.step.getCallbackOfType(a.CallbackType.ChoiceCallback)},t}return o(t,e),t.prototype.getSubtitleMarkup=function(e){return 3===e?"<p>You'll need to verify it's you to continue signing in to your account.</p>":"<p>You'll need a verification code to continue signing in to your account.</p>"},t.prototype.getChoicesMarkup=function(e){return'<ul class="fr-list">\n    '+e.map((function(e,t){return'<li class="fr-list-item fr-icon-list-'+e.icon+'" data-choice="'+t+'">'+e.text+"</li>"})).join("")+"</ul>"},t.prototype.updateChoiceStrings=function(e){var t=2===e.length;return e.map((function(e){var n=e.toLowerCase();switch(e){case"Device":return{icon:n,text:"Use your device"};case"Email":return{icon:n,text:t?"Receive an email":"Email a code"};case"SMS":return{icon:n,text:t?"Receive a text":"Text a code"};default:throw new Error('Unsupported choice "'+e+'"')}}))},t}(u.default);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceTokens=void 0;t.replaceTokens=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e=e.replace(new RegExp("{"+n+"}","g"),t[n]));return e}},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-choice">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Use device sign-in</h1>\n      <i class="fr-icon fr-icon-web-authn"></i>\n      <p>Use your device\'s security features to sign in.</p>\n    </header>\n    <section class="fr-form">\n      <div class="fr-input-group">\n        <button type="button" class="btn btn-primary" data-choice="0">\n          Turn on device sign in\n        </button>\n      </div>\n      <button type="button" class="btn btn-primary mt-3" data-choice="1">\n        More ways to sign in\n      </button>\n    </section>\n  </section>\n</main>'},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-choice">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Go passwordless</h1>\n      <i class="fr-icon fr-icon-web-authn"></i>\n      <p>Never enter your password again by using your device\'s security features to sign in.</p>\n    </header>\n    <section class="fr-form">\n      <div class="fr-input-group">\n        <button type="button" class="btn btn-primary" data-choice="0">\n          Set up passwordless\n        </button>\n      </div>\n      <button type="button" class="btn btn-primary mt-3" data-choice="1">\n        Skip this\n      </button>\n    </section>\n  </section>\n</main>\n'},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-choice">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>2-step verification</h1>\n      <i class="fr-icon fr-icon-check-user"></i>\n      {SUBTITLE}\n    </header>\n  </section>\n  <section class="fr-form">\n    <section>\n      {CHOICES}\n    </section>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),s=u(n(2)),l=u(n(32)),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=void 0,t.getRefs=function(){t.heading=t.findElement("h2")},t.render=function(){t.target.innerHTML=l.default,t.invokeWebAuthn()},t.invokeWebAuthn=function(){return i(t,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return this.heading.innerHTML="Confirming device credentials...",[4,c.FRWebAuthn.authenticate(this.step)];case 1:return e=t.sent(),this.deferred.resolve(e),[2]}}))}))},t}return o(t,e),t}(s.default);t.default=f},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-device-authentication">\n  <section class="fr-main">\n    <header class="fr-header">\n      <div class="fr-spinner"></div>\n      <h2>Waiting for device...</h2>\n    </header>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),s=u(n(2)),l=u(n(34)),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=void 0,t.getRefs=function(){t.heading=t.findElement("h2")},t.render=function(){t.target.innerHTML=l.default,t.invokeWebAuthn()},t.invokeWebAuthn=function(){return i(t,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return this.heading.innerHTML="Acquiring device credentials...",[4,c.FRWebAuthn.register(this.step)];case 1:return e=t.sent(),this.deferred.resolve(e),[2]}}))}))},t}return o(t,e),t}(s.default);t.default=f},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-device-registration">\n  <section class="fr-main">\n    <header class="fr-header">\n      <div class="fr-spinner"></div>\n      <h2>Waiting for device...</h2>\n    </header>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(4)),c=i(n(7)),s=i(n(2)),l=i(n(3)),f=n(6),d=i(n(36)),p=i(n(37)),h=i(n(38)),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=function(){return t.deferred=new l.default,t.retryMessage.style.display="block",t.submit.enable(),t.bind(),t.deferred.promise},t.bind=function(){t.submit.bind(t.onSubmit),t.passwordInput.bind()},t.unbind=function(){t.submit.unbind(t.onSubmit),t.passwordInput.unbind()},t.getRefs=function(){t.password=t.findElement("#fr-password"),t.submit=new u.default(t.findElement(".btn-primary")),t.retryMessage=t.findElement(".fr-retry"),t.passwordInput=new c.default(t.password)},t.getTemplate=function(){switch(t.step.getStage()){case f.ExpressStage.OneTimePasswordEmail:return d.default;case f.ExpressStage.OneTimePasswordSMS:return p.default;case f.ExpressStage.UserPassword:return h.default}throw new Error('Unsupported password stage "'+t.step.getStage()+'"')},t.ready=function(){t.password.focus()},t.onSubmit=function(){t.submit.disable(),t.step.setCallbackValue(a.CallbackType.PasswordCallback,t.password.value),t.unbind(),t.deferred.resolve(t.step)},t}return o(t,e),t}(s.default);t.default=b},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-one-time-password-email">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>2-step verification</h1>\n      <i class="fr-icon fr-icon-twofa-email"></i>\n      <p>We\'ve sent a code to your email</p>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Enter code" autofocus />\n            <label for="fr-password">Enter code</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button"><i\n                class="material-icons material-icons-outlined">visibility_off</i></button>\n          </div>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Next</button>\n  </section>\n  <div class="fr-error fr-retry">\n    <div class="fr-alert">Sorry that isn‘t right. Try again.</div>\n  </div>\n  <footer class="fr-footer">\n    <nav>\n      <ul>\n        <li><a href="#">More ways to sign in</a></li>\n      </ul>\n    </nav>\n  </footer>\n</main>'},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-one-time-password-sms">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>2-step verification</h1>\n      <i class="fr-icon fr-icon-twofa-sms"></i>\n      <p>We\'ve sent a code to your phone</p>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Enter code" autofocus />\n            <label for="fr-password">Enter code</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button">\n              <i class="material-icons material-icons-outlined">visibility_off</i>\n            </button>\n          </div>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Next</button>\n  </section>\n  <div class="fr-error fr-retry">\n    <div class="fr-alert">Sorry that isn‘t right. Try again.</div>\n  </div>\n  <footer class="fr-footer">\n    <nav>\n      <ul>\n        <li><a href="#">More ways to sign in</a></li>\n      </ul>\n    </nav>\n  </footer>\n</main>\n'},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-username-password">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Sign in</h1>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Password" autofocus />\n            <label for="fr-password">Password</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button"><i\n                class="material-icons material-icons-outlined">visibility_off</i></button>\n          </div>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Next</button>\n    <div class="fr-error fr-retry">\n      <div class="fr-alert">Sorry that isn‘t right. Try again.</div>\n    </div>\n  </section>\n</main>'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),s=u(n(4)),l=u(n(7)),f=u(n(2)),d=u(n(3)),p=u(n(40)),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=function(){return t.deferred=new d.default,t.retryMessage.style.display="block",t.submit.enable(),t.bind(),t.deferred.promise},t.bind=function(){t.passwordInput.bind(),t.submit.bind(t.onSubmit)},t.unbind=function(){t.passwordInput.unbind(),t.submit.unbind(t.onSubmit)},t.getRefs=function(){t.username=t.findElement("#fr-username"),t.password=t.findElement("#fr-password"),t.passwordInput=new l.default(t.password),t.retryMessage=t.findElement(".fr-retry"),t.submit=new s.default(t.findElement(".btn-primary")),t.addAttributeInputs()},t.getTemplate=function(){return p.default},t.ready=function(){t.username.focus()},t.addAttributeInputs=function(){for(var e=t.findElement("#fr-attributes"),n=[],r=0,o=t.step.getCallbacksOfType(c.CallbackType.StringAttributeInputCallback);r<o.length;r++){var i=o[r],a=i.getName(),u=i.getPrompt();if(a&&u){var s=document.createElement("div");s.className="form-group";var l=document.createElement("div");l.className="form-label-group mb-0";var f=document.createElement("input");f.className="form-control",f.id="fr-"+a,f.name=a,f.placeholder=u,f.required=!0,f.type="text";var d=document.createElement("label");d.htmlFor=f.id,d.innerHTML=u,l.append(f),l.append(d),s.append(l),n.push(s)}}for(;e.firstChild;)e.removeChild(e.firstChild);e.append.apply(e,n)},t.onSubmit=function(){return i(t,void 0,void 0,(function(){var e,t,n,r,o,i;return a(this,(function(a){for(this.submit.disable("Registering..."),this.step.setCallbackValue(c.CallbackType.ValidatedCreateUsernameCallback,this.username.value),this.step.setCallbackValue(c.CallbackType.ValidatedCreatePasswordCallback,this.password.value),e=this.step.getCallbacksOfType(c.CallbackType.StringAttributeInputCallback),t=0,n=e;t<n.length;t++)r=n[t],(o=r.getName())&&(i=this.findElement("#fr-"+o))&&r.setInputValue(i.value);return this.unbind(),this.deferred.resolve(this.step),[2]}))}))},t}return o(t,e),t}(f.default);t.default=h},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-user">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Create an Account</h1>\n    </header>\n    <form class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group mb-0">\n          <input required class="form-control" id="fr-username" type="text" name="username" placeholder="Username"\n            autofocus />\n          <label for="fr-username">Username</label>\n        </div>\n      </div>\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Password" />\n            <label for="fr-password">Password</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button"><i\n                class="material-icons material-icons-outlined">visibility_off</i></button>\n          </div>\n        </div>\n      </div>\n      <div id="fr-attributes"></div>\n    </form>\n    <button type="button" class="btn btn-primary">Register</button>\n    <div class="fr-error fr-retry">\n      <div class="fr-alert">Sorry that isn‘t right. Try again.</div>\n    </div>\n  </section>\n</main>'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(4)),c=i(n(2)),s=i(n(3)),l=i(n(42)),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=function(){return t.deferred=new s.default,t.retryMessage.style.display="block",t.submit.enable(),t.bind(),t.deferred.promise},t.bind=function(){t.submit.bind(t.onSubmit)},t.unbind=function(){t.submit.unbind(t.onSubmit)},t.getRefs=function(){t.retryMessage=t.findElement(".fr-retry"),t.submit=new u.default(t.findElement(".btn-primary")),t.username=t.findElement("#fr-username")},t.getTemplate=function(){return l.default},t.ready=function(){t.username.focus()},t.onSubmit=function(){t.submit.disable(),t.step.setCallbackValue(a.CallbackType.NameCallback,t.username.value),t.unbind(),t.deferred.resolve(t.step)},t}return o(t,e),t}(c.default);t.default=f},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-username">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Sign in</h1>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group mb-0">\n          <input required class="form-control" id="fr-username" type="text" name="username" placeholder="Username"\n            autofocus />\n          <label for="fr-username">Username</label>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Next</button>\n    <div class="fr-error fr-retry">\n      <div class="fr-alert">Sorry that isn‘t right. Try again.</div>\n    </div>\n  </section>\n</main>'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(4)),c=i(n(7)),s=i(n(2)),l=i(n(3)),f=i(n(44)),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=function(){return t.deferred=new l.default,t.retryMessage.style.display="block",t.submit.enable(),t.bind(),t.deferred.promise},t.bind=function(){t.submit.bind(t.onSubmit),t.passwordInput.bind()},t.unbind=function(){t.submit.unbind(t.onSubmit),t.passwordInput.unbind()},t.getRefs=function(){t.username=t.findElement("#fr-username"),t.password=t.findElement("#fr-password"),t.retryMessage=t.findElement(".fr-retry"),t.submit=new u.default(t.findElement(".btn-primary")),t.passwordInput=new c.default(t.password)},t.getTemplate=function(){return f.default},t.ready=function(){t.username.focus()},t.onSubmit=function(){t.submit.disable(),t.step.setCallbackValue(a.CallbackType.NameCallback,t.username.value),t.step.setCallbackValue(a.CallbackType.PasswordCallback,t.password.value),t.unbind(),t.deferred.resolve(t.step)},t}return o(t,e),t}(s.default);t.default=d},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-username-password">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Sign in</h1>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group mb-0">\n          <input required class="form-control" id="fr-username" type="text" name="username" placeholder="Username"\n            autofocus />\n          <label for="fr-username">Username</label>\n        </div>\n      </div>\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Password" />\n            <label for="fr-password">Password</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button"><i\n                class="material-icons material-icons-outlined">visibility_off</i></button>\n          </div>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Sign In</button>\n  </section>\n  <div class="fr-error fr-retry">\n    <div class="fr-alert">Sorry that isn‘t right. Try again.</div>\n  </div>\n</main>'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),s=u(n(8)),l=n(46),f=n(47),d=function(e){function t(t){var n=e.call(this)||this;if(n.options={handlerFactory:s.default,targetId:l.TARGET_ID},n.successfulStages=[],n.getSession=function(e){return i(n,void 0,void 0,(function(){return a(this,(function(t){return this.successfulStages=[],[2,this.nextStep(void 0,e)]}))}))},n.clearState=function(){return n},n.firstStepTimedOut=function(e){var t=0===n.successfulStages.length,r=e.getReason()===c.ErrorCode.Timeout;return t&&r},n.getNewFirstAuthId=function(){return i(n,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,c.FRAuth.next()];case 1:return[2,e.sent().payload.authId]}}))}))},Object.assign(n.options,t),"function"!=typeof n.options.handlerFactory)throw new Error("No step handler factory is specified");var r=n.options.targetId||l.TARGET_ID,o=document.getElementById(r);if(null===o)throw new Error('No element with id "'+r+'" found');return n.el=o,n}return o(t,e),t.prototype.nextStep=function(e,t){return i(this,void 0,void 0,(function(){var n,r,o;return a(this,(function(i){switch(i.label){case 0:return i.trys.push([0,11,,12]),[4,c.FRAuth.next(e,t)];case 1:switch(n=i.sent(),this.dispatchEvent({step:n,type:f.FREventType.StepChange}),n.type){case c.StepType.LoginSuccess:return[3,2];case c.StepType.LoginFailure:return[3,3]}return[3,8];case 2:return[2,n];case 3:return e&&this.firstStepTimedOut(n)?(r=e.payload,[4,this.getNewFirstAuthId()]):[3,5];case 4:return r.authId=i.sent(),[2,this.nextStep(e)];case 5:return this.handler&&this.handler.retry?[4,this.handler.retry()]:[3,7];case 6:return e=i.sent(),[2,this.nextStep(e)];case 7:return[2,n];case 8:if(e&&this.successfulStages.push(e),!this.options.handlerFactory)throw new Error("No handler factory is configured");if(this.handler=this.options.handlerFactory(this.el,n),!this.handler)throw new Error("Handler factory failed to produce a handler");return[4,this.handler.completeStep()];case 9:return n=i.sent(),[2,this.nextStep(n)];case 10:return[3,12];case 11:return o=i.sent(),this.dispatchEvent({step:e,type:f.FREventType.StepError,error:o}),[2,new c.FRLoginFailure({code:0,detail:void 0,message:o.message||"Unknown",reason:"Unknown"})];case 12:return[2]}}))}))},t}(c.Dispatcher);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TARGET_ID=void 0;t.TARGET_ID="fr-ui"},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.FREventType=void 0,function(e){e.StepChange="step_change",e.StepError="step_error"}(r||(r={})),t.FREventType=r}])}));
//# sourceMappingURL=index.js.map