!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("forgerock",[],t):"object"==typeof exports?exports.forgerock=t():e.forgerock=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=19)}([function(e,t,n){"use strict";n.r(t);var r=5e3,o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=function(){function e(){}return e.set=function(e){if(!this.isValid(e))throw new Error("Configuration is invalid");e.serverConfig&&this.validateServerConfig(e.serverConfig),this.options=o({},e)},e.get=function(e){if(!this.options&&!e)throw new Error("Configuration has not been set");var t=o(o({},this.options),e);if(!t.serverConfig||!t.serverConfig.baseUrl)throw new Error("Server configuration has not been set");return t},e.isValid=function(e){return!(!e||!e.serverConfig)},e.validateServerConfig=function(e){e.timeout||(e.timeout=r);var t=e.baseUrl;t&&"/"!==t.charAt(t.length-1)&&(e.baseUrl=t+"/")},e}();function a(e){var t=(e||"").split("/").map((function(e){return e.trim()})).filter((function(e){return""!==e}));return"root"!==t[0]&&t.unshift("root"),t.map((function(e){return"realms/"+e})).join("/")}function u(e,t){void 0===t&&(t=r);var n=t||r;return Promise.race([e,new Promise((function(e,t){return window.setTimeout((function(){return t(new Error("Timeout"))}),n)}))])}var s=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};function c(e){var t="http:"===e.protocol&&-1===["","80"].indexOf(e.port)||"https:"===e.protocol&&-1===["","443"].indexOf(e.port)?":"+e.port:"";return e.protocol+"//"+e.hostname+t}function l(e,t){var n=new URL(e);if(t.startsWith("/"))return""+c(n)+t;var r=n.pathname.split("/"),o=t.split("/").filter((function(e){return!!e})),i=s(r.slice(0,-1),o).join("/");return""+c(n)+i}function f(e){var t=[];for(var n in e)e[n]&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}var p,d,h=function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},b=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},y=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},v=function(){function e(){}return e.next=function(e,t){return b(this,void 0,void 0,(function(){var n,r,o,a,s,c,l,f;return y(this,(function(p){switch(p.label){case 0:return n=i.get(t),r=n.realmPath,o=n.serverConfig,a=n.tree,s=t?t.query:{},c=this.constructUrl(o,r,a,s),l=this.configureRequest(e),[4,u(fetch(c,l),o.timeout)];case 1:return f=p.sent(),[4,this.getResponseJson(f)];case 2:return[2,p.sent()]}}))}))},e.constructUrl=function(e,t,n,r){var o=a(t),i=n?{authIndexType:"service",authIndexValue:n}:void 0,u=h(h({},r),i),s="json/"+o+"/authenticate"+(Object.keys(u).length>0?"?"+f(u):"");return l(e.baseUrl,s)},e.configureRequest=function(e){return{body:e?JSON.stringify(e):void 0,credentials:"include",headers:{accept:"application/json","accept-api-version":"protocol=1.0,resource=2.1","content-type":"application/json","x-requested-with":"forgerock-sdk"},method:"POST"}},e.getResponseJson=function(e){return b(this,void 0,void 0,(function(){var t,n;return y(this,(function(r){switch(r.label){case 0:return t=e.headers.get("content-type"),t&&t.indexOf("application/json")>-1?[4,e.json()]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=void 0,r.label=3;case 3:return[2,n]}}))}))},e}();!function(e){e.BadRequest="BAD_REQUEST",e.Timeout="TIMEOUT",e.Unauthorized="UNAUTHORIZED",e.Unknown="UNKNOWN"}(p||(p={})),function(e){e.BooleanAttributeInputCallback="BooleanAttributeInputCallback",e.ChoiceCallback="ChoiceCallback",e.ConfirmationCallback="ConfirmationCallback",e.HiddenValueCallback="HiddenValueCallback",e.KbaCreateCallback="KbaCreateCallback",e.MetadataCallback="MetadataCallback",e.NameCallback="NameCallback",e.PasswordCallback="PasswordCallback",e.PollingWaitCallback="PollingWaitCallback",e.ReCaptchaCallback="ReCaptchaCallback",e.StringAttributeInputCallback="StringAttributeInputCallback",e.TermsAndConditionsCallback="TermsAndConditionsCallback",e.TextOutputCallback="TextOutputCallback",e.ValidatedCreatePasswordCallback="ValidatedCreatePasswordCallback",e.ValidatedCreateUsernameCallback="ValidatedCreateUsernameCallback"}(d||(d={}));var g,m,w=function(){function e(){this.callbacks={}}return e.prototype.addEventListener=function(e,t){!function(e,t,n){e[t]=e[t]||[],e[t].indexOf(n)<0&&e[t].push(n)}(this.callbacks,e,t)},e.prototype.removeEventListener=function(e,t){!function(e,t,n){if(e[t]){var r=e[t].indexOf(n);r>=0&&e[t].splice(r,1)}}(this.callbacks,e,t)},e.prototype.clearEventListeners=function(e){!function(e,t){Object.keys(e).forEach((function(n){t&&n!==t||delete e[n]}))}(this.callbacks,e)},e.prototype.dispatchEvent=function(e){if(this.callbacks[e.type])for(var t=0,n=this.callbacks[e.type];t<n.length;t++){(0,n[t])(e)}},e}();function C(e,t,n){return 1===e?t:void 0!==n?n:t+"s"}function k(e,t,n){return e&&void 0!==e[t]?e[t]:n}!function(e){e.CannotContainCharacters="CANNOT_CONTAIN_CHARACTERS",e.CannotContainDuplicates="CANNOT_CONTAIN_DUPLICATES",e.CannotContainOthers="CANNOT_CONTAIN_OTHERS",e.LeastCapitalLetters="AT_LEAST_X_CAPITAL_LETTERS",e.LeastNumbers="AT_LEAST_X_NUMBERS",e.MatchRegexp="MATCH_REGEXP",e.MaximumLength="MAX_LENGTH",e.MaximumNumber="MAXIMUM_NUMBER_VALUE",e.MinimumLength="MIN_LENGTH",e.MinimumNumber="MINIMUM_NUMBER_VALUE",e.Required="REQUIRED",e.Unique="UNIQUE",e.UnknownPolicy="UNKNOWN_POLICY",e.ValidArrayItems="VALID_ARRAY_ITEMS",e.ValidDate="VALID_DATE",e.ValidEmailAddress="VALID_EMAIL_ADDRESS_FORMAT",e.ValidNameFormat="VALID_NAME_FORMAT",e.ValidNumber="VALID_NUMBER",e.ValidPhoneFormat="VALID_PHONE_FORMAT",e.ValidQueryFilter="VALID_QUERY_FILTER",e.ValidType="VALID_TYPE"}(g||(g={}));var _,O=((m={})[g.CannotContainCharacters]=function(e,t){return e+' must not contain following characters: "'+k(t,"forbiddenChars","")+'"'},m[g.CannotContainDuplicates]=function(e,t){return e+'  must not contain duplicates: "'+k(t,"duplicateValue","")+'"'},m[g.CannotContainOthers]=function(e,t){return e+' must not contain: "'+k(t,"disallowedFields","")+'"'},m[g.LeastCapitalLetters]=function(e,t){var n=k(t,"numCaps",0);return e+" must contain at least "+n+" capital "+C(n,"letter")},m[g.LeastNumbers]=function(e,t){var n=k(t,"numNums",0);return e+" must contain at least "+n+" numeric "+C(n,"value")},m[g.MatchRegexp]=function(e){return e+' has failed the "MATCH_REGEXP" policy'},m[g.MaximumLength]=function(e,t){var n=k(t,"maxLength",0);return e+" must be at most "+n+" "+C(n,"character")},m[g.MaximumNumber]=function(e){return e+' has failed the "MAXIMUM_NUMBER_VALUE" policy'},m[g.MinimumLength]=function(e,t){var n=k(t,"minLength",0);return e+" must be at least "+n+" "+C(n,"character")},m[g.MinimumNumber]=function(e){return e+' has failed the "MINIMUM_NUMBER_VALUE" policy'},m[g.Required]=function(e){return e+" is required"},m[g.Unique]=function(e){return e+" must be unique"},m[g.UnknownPolicy]=function(e,t){return e+': Unknown policy requirement "'+k(t,"policyRequirement","Unknown")+'"'},m[g.ValidArrayItems]=function(e){return e+' has failed the "VALID_ARRAY_ITEMS" policy'},m[g.ValidDate]=function(e){return e+" has an invalid date"},m[g.ValidEmailAddress]=function(e){return e+" has an invalid email address"},m[g.ValidNameFormat]=function(e){return e+" has an invalid name format"},m[g.ValidNumber]=function(e){return e+" has an invalid number"},m[g.ValidPhoneFormat]=function(e){return e+" has an invalid phone number"},m[g.ValidQueryFilter]=function(e){return e+' has failed the "VALID_QUERY_FILTER" policy'},m[g.ValidType]=function(e){return e+' has failed the "VALID_TYPE" policy'},m),P=function(){return(P=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},E=function(){function e(){}return e.parseErrors=function(e,t){var n=this,r=[];return e.detail&&e.detail.failedPolicyRequirements&&e.detail.failedPolicyRequirements.map((function(e){r.push.apply(r,[{detail:e,messages:n.parseFailedPolicyRequirement(e,t)}])})),r},e.parseFailedPolicyRequirement=function(e,t){var n=this,r=[];return e.policyRequirements.map((function(o){r.push(n.parsePolicyRequirement(e.property,o,t))})),r},e.parsePolicyRequirement=function(e,t,n){void 0===n&&(n={});var r="string"==typeof t?JSON.parse(t):P({},t),o=r.policyRequirement;return(n[o]||O[o]||O[g.UnknownPolicy])(e,r.params?P(P({},r.params),{policyRequirement:o}):{policyRequirement:o})},e}();!function(e){e.LoginFailure="LoginFailure",e.LoginSuccess="LoginSuccess",e.Step="Step"}(_||(_={}));var T,S=function(){function e(e){this.payload=e,this.type=_.LoginFailure}return e.prototype.getCode=function(){return Number(this.payload.code)},e.prototype.getDetail=function(){return this.payload.detail},e.prototype.getMessage=function(){return this.payload.message},e.prototype.getProcessedMessage=function(e){return E.parseErrors(this.payload,e)},e.prototype.getReason=function(){return this.payload.reason},e}(),x=function(){function e(e){this.payload=e,this.type=_.LoginSuccess}return e.prototype.getRealm=function(){return this.payload.realm},e.prototype.getSessionToken=function(){return this.payload.tokenId},e.prototype.getSuccessUrl=function(){return this.payload.successUrl},e}(),A=function(){function e(e){this.payload=e}return e.prototype.getType=function(){return this.payload.type},e.prototype.getInputValue=function(e){return void 0===e&&(e=0),this.getArrayElement(this.payload.input,e).value},e.prototype.setInputValue=function(e,t){void 0===t&&(t=0),this.getArrayElement(this.payload.input,t).value=e},e.prototype.getOutputValue=function(e){return void 0===e&&(e=0),this.getArrayElement(this.payload.output,e).value},e.prototype.getOutputByName=function(e,t){var n=this.payload.output.find((function(t){return t.name===e}));return n?n.value:t},e.prototype.getArrayElement=function(e,t){if(void 0===t&&(t=0),void 0===e)throw new Error("No NameValue array was provided to search (selector "+t+")");if("number"==typeof t){if(t<0||t>e.length-1)throw new Error("Selector index "+t+" is out of range");return e[t]}if("string"==typeof t){var n=e.find((function(e){return e.name===t}));if(!n)throw new Error('Missing callback input entry "'+t+'"');return n}throw new Error("Invalid selector value type")},e}(),M=(T=function(e,t){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}T(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),R=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return M(t,e),t.prototype.getName=function(){return this.getOutputByName("name","")},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.setValue=function(e){this.setInputValue(e)},t}(A),I=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return I(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getDefaultChoice=function(){return this.getOutputByName("defaultChoice",0)},t.prototype.getChoices=function(){return this.getOutputByName("choices",[])},t.prototype.setChoiceIndex=function(e){var t=this.getChoices().length;if(e<0||e>t-1)throw new Error(e+" is out of bounds");this.setInputValue(e)},t.prototype.setChoiceValue=function(e){var t=this.getChoices().indexOf(e);if(-1===t)throw new Error('"'+e+'" is not a valid choice');this.setInputValue(t)},t}(A),L=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),j=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return L(t,e),t.prototype.getDefaultOption=function(){return Number(this.getOutputByName("defaultOption",0))},t.prototype.getMessageType=function(){return Number(this.getOutputByName("messageType",0))},t.prototype.getOptions=function(){return this.getOutputByName("options",[])},t.prototype.getOptionType=function(){return Number(this.getOutputByName("optionType",0))},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t}(A),V=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),U=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return V(t,e),t}(A),F=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),B=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return F(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getPredefinedQuestions=function(){return this.getOutputByName("predefinedQuestions",[])},t.prototype.setQuestion=function(e){this.setValue("question",e)},t.prototype.setAnswer=function(e){this.setValue("answer",e)},t.prototype.setValue=function(e,t){if(!this.payload.input)throw new Error("KBA payload is missing input");var n=this.payload.input.find((function(t){return t.name.endsWith(e)}));if(!n)throw new Error('No input has name ending in "'+e+'"');n.value=t},t}(A),D=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),H=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return D(t,e),t.prototype.getData=function(){return this.getOutputByName("data",{})},t}(A),q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),W=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return q(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.setName=function(e){this.setInputValue(e)},t}(A),K=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),G=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return K(t,e),t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.setPassword=function(e){this.setInputValue(e)},t}(A),Q=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),J=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return Q(t,e),t.prototype.getMessage=function(){return this.getOutputByName("message","")},t.prototype.getWaitTime=function(){return Number(this.getOutputByName("waitTime",0))},t}(A),z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Y=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return z(t,e),t.prototype.getSiteKey=function(){return this.getOutputByName("recaptchaSiteKey","")},t.prototype.setResult=function(e){this.setInputValue(e)},t}(A),X=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return X(t,e),t.prototype.getTerms=function(){return this.getOutputByName("terms","")},t.prototype.getVersion=function(){return this.getOutputByName("version","")},t.prototype.getCreateDate=function(){var e=this.getOutputByName("createDate","");return new Date(e)},t.prototype.setAccepted=function(e){void 0===e&&(e=!0),this.setInputValue(e)},t}(A),Z=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return Z(t,e),t.prototype.getMessage=function(){return this.getOutputByName("message","")},t.prototype.getMessageType=function(){return this.getOutputByName("messageType","")},t}(A),te=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ne=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return te(t,e),t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.setPassword=function(e){this.setInputValue(e)},t}(A),re=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),oe=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return re(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.setName=function(e){this.setInputValue(e)},t}(A);var ie=function(e){switch(e.type){case d.BooleanAttributeInputCallback:return new R(e);case d.ChoiceCallback:return new N(e);case d.ConfirmationCallback:return new j(e);case d.HiddenValueCallback:return new U(e);case d.KbaCreateCallback:return new B(e);case d.MetadataCallback:return new H(e);case d.NameCallback:return new W(e);case d.PasswordCallback:return new G(e);case d.PollingWaitCallback:return new J(e);case d.ReCaptchaCallback:return new Y(e);case d.StringAttributeInputCallback:return new R(e);case d.TermsAndConditionsCallback:return new $(e);case d.TextOutputCallback:return new ee(e);case d.ValidatedCreatePasswordCallback:return new ne(e);case d.ValidatedCreateUsernameCallback:return new oe(e);default:return new A(e)}},ae=function(){function e(e,t){this.payload=e,this.type=_.Step,this.callbacks=[],e.callbacks&&(this.callbacks=this.convertCallbacks(e.callbacks,t))}return e.prototype.getCallbackOfType=function(e){var t=this.getCallbacksOfType(e);if(1!==t.length)throw new Error('Expected 1 callback of type "'+e+'", but found '+t.length);return t[0]},e.prototype.getCallbacksOfType=function(e){return this.callbacks.filter((function(t){return t.getType()===e}))},e.prototype.setCallbackValue=function(e,t){var n=this.getCallbacksOfType(e);if(1!==n.length)throw new Error('Expected 1 callback of type "'+e+'", but found '+n.length);n[0].setInputValue(t)},e.prototype.getDescription=function(){return this.payload.description},e.prototype.getHeader=function(){return this.payload.header},e.prototype.getStage=function(){return this.payload.stage},e.prototype.convertCallbacks=function(e,t){return e.map((function(e){return(t||ie)(e)||ie(e)}))},e}(),ue=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},se=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ce=function(){function e(){}return e.next=function(e,t){return ue(this,void 0,void 0,(function(){var n,r;return se(this,(function(o){switch(o.label){case 0:return[4,v.next(e?e.payload:void 0,t)];case 1:return(n=o.sent()).tokenId?[2,new x(n)]:n.authId?(r=t?t.callbackFactory:void 0,[2,new ae(n,r)]):[2,new S(n)]}}))}))},e}(),le="forgerock-sdk",fe=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},pe=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},de=function(){function e(){}return e.get=function(){return fe(this,void 0,void 0,(function(){var e,t=this;return pe(this,(function(n){return e=this.getClientId(),[2,new Promise((function(n,r){var o=function(){return r()},i=window.indexedDB.open(le);i.onsuccess=function(){if(!i.result.objectStoreNames.contains(e))return i.result.close(),n(void 0);var r=i.result.transaction(e,"readonly").objectStore(e).get("tokens");r.onsuccess=function(e){var r=t.getResult(e);i.result.close(),n(r)},r.onerror=o},i.onupgradeneeded=function(){i.result.close(),n(void 0)},i.onerror=o}))]}))}))},e.set=function(e){return fe(this,void 0,void 0,(function(){var t;return pe(this,(function(n){return t=this.getClientId(),[2,new Promise((function(n,r){var o=window.indexedDB.open(le),i=function(){o.result.close(),n()},a=function(){return r()},u=function(){o.result.createObjectStore(t)},s=function(){if(!o.result.objectStoreNames.contains(t)){var n=o.result.version+1;return o.result.close(),(o=window.indexedDB.open(le,n)).onupgradeneeded=u,o.onsuccess=s,void(o.onerror=a)}var r=o.result.transaction(t,"readwrite");r.onerror=a;var c=r.objectStore(t).put(e,"tokens");c.onsuccess=i,c.onerror=a};o.onupgradeneeded=u,o.onsuccess=s,o.onerror=a}))]}))}))},e.remove=function(){return fe(this,void 0,void 0,(function(){var e;return pe(this,(function(t){return e=this.getClientId(),[2,new Promise((function(t,n){var r=function(){return n()},o=window.indexedDB.open(le);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(e))return t();var n=o.result.transaction(e,"readwrite").objectStore(e).delete("tokens");n.onsuccess=function(){t()},n.onerror=r},o.onerror=r}))]}))}))},e.getClientId=function(){var e=i.get().clientId;if(!e)throw new Error("clientId is required to manage token storage");return e},e.getResult=function(e){if(!e||!e.target)throw new Error("Missing storage event target");return e.target.result},e}();function he(e){return e.ok||4===Math.floor(e.status/100)}var be,ye=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},ve=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ge=function(){function e(){}return e.createVerifier=function(e){void 0===e&&(e=32);var t=new Uint8Array(e);return window.crypto.getRandomValues(t),this.base64UrlEncode(t)},e.createChallenge=function(e){return ye(this,void 0,void 0,(function(){var t;return ve(this,(function(n){switch(n.label){case 0:return[4,this.sha256(e)];case 1:return t=n.sent(),[2,this.base64UrlEncode(t)]}}))}))},e.base64UrlEncode=function(e){var t=Array.prototype.slice.call(e);return window.btoa(String.fromCharCode.apply(null,t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},e.sha256=function(e){return ye(this,void 0,void 0,(function(){var t,n;return ve(this,(function(r){switch(r.label){case 0:return t=(new TextEncoder).encode(e),[4,window.crypto.subtle.digest("SHA-256",t)];case 1:return n=r.sent(),[2,new Uint8Array(n)]}}))}))},e}();!function(e){e.Code="code",e.Token="token"}(be||(be={}));var me=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},we=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ce=function(){function e(){}return e.getAuthorizeUrl=function(e){return me(this,void 0,void 0,(function(){var t,n,r,o,a,u,s,c,l=this;return we(this,(function(f){switch(f.label){case 0:return t=i.get(e),n=t.serverConfig,r=t.clientId,o=t.redirectUri,a=t.scope,u={client_id:r,redirect_uri:o,response_type:e.responseType,scope:a,state:e.state},e.verifier?[4,ge.createChallenge(e.verifier)]:[3,2];case 1:s=f.sent(),u.code_challenge=s,u.code_challenge_method="S256",f.label=2;case 2:return c=this.getUrl("authorize",u,e),[2,new Promise((function(e,t){var r,o=document.createElement("iframe"),i=function(){},a=i,u=0;r=function(){window.clearTimeout(u),o.removeEventListener("load",a),o.remove()},a=function(){if(o.contentWindow){var t=o.contentWindow.location.href;l.containsAuthCode(t)&&(r(),e(t))}},u=window.setTimeout((function(){r(),t("Timeout")}),n.timeout),o.style.display="none",o.addEventListener("load",a),document.body.appendChild(o),o.src=c}))]}}))}))},e.getOAuth2Tokens=function(e){return me(this,void 0,void 0,(function(){var t,n,r,o,a,u,s,c,l,p;return we(this,(function(d){switch(d.label){case 0:return t=i.get(e),n=t.clientId,r=t.redirectUri,o={client_id:n,code:e.authorizationCode,grant_type:"authorization_code",redirect_uri:r},e.verifier&&(o.code_verifier=e.verifier),a=f(o),u={body:a,headers:{"content-length":a.length.toString(),"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("access_token",void 0,!1,u,e)];case 1:return s=d.sent(),[4,this.getBody(s)];case 2:if(c=d.sent(),200!==s.status)throw l="string"==typeof c?"Expected 200, received "+s.status:this.parseError(c),new Error(l);if(!(p=c).access_token)throw new Error("Access token not found in response");return[2,{accessToken:p.access_token,idToken:p.id_token,refreshToken:p.refresh_token}]}}))}))},e.getUserInfo=function(e){return me(this,void 0,void 0,(function(){var t;return we(this,(function(n){switch(n.label){case 0:return[4,this.request("userinfo",void 0,!0,void 0,e)];case 1:if(200!==(t=n.sent()).status)throw new Error("Failed to get user info; received "+t.status);return[4,t.json()];case 2:return[2,n.sent()]}}))}))},e.endSession=function(e){return me(this,void 0,void 0,(function(){var t,n,r;return we(this,(function(o){switch(o.label){case 0:return[4,de.get()];case 1:return t=o.sent().idToken,n={},t&&(n.id_token_hint=t),[4,this.request("connect/endSession",n,!0,void 0,e)];case 2:if(!he(r=o.sent()))throw new Error("Failed to end session; received "+r.status);return[2]}}))}))},e.revokeToken=function(e){return me(this,void 0,void 0,(function(){var t,n,r,o;return we(this,(function(a){switch(a.label){case 0:return t=i.get(e).clientId,[4,de.get()];case 1:return n=a.sent().accessToken,r={body:f({client_id:t,token:n}),credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("token/revoke",void 0,!1,r,e)];case 2:if(!he(o=a.sent()))throw new Error("Failed to revoke token; received "+o.status);return[2]}}))}))},e.request=function(e,t,n,r,o){return me(this,void 0,void 0,(function(){var a,s,c;return we(this,(function(l){switch(l.label){case 0:return a=i.get(o).serverConfig,s=this.getUrl(e,t,o),r=r||{},n?[4,de.get()]:[3,2];case 1:c=l.sent().accessToken,r.credentials="include",r.headers=r.headers||new Headers,r.headers.set("authorization","Bearer "+c),l.label=2;case 2:return[4,u(fetch(s,r),a.timeout)];case 3:return[2,l.sent()]}}))}))},e.containsAuthCode=function(e){return!!e&&/code=([^&]+)/.test(e)},e.getBody=function(e){return me(this,void 0,void 0,(function(){var t;return we(this,(function(n){switch(n.label){case 0:return(t=e.headers.get("content-type"))&&t.indexOf("application/json")>-1?[4,e.json()]:[3,2];case 1:return[2,n.sent()];case 2:return[4,e.text()];case 3:return[2,n.sent()]}}))}))},e.parseError=function(e){if(e){if(e.error&&e.error_description)return e.error+": "+e.error_description;if(e.code&&e.message)return e.code+": "+e.message}},e.getUrl=function(e,t,n){var r=i.get(n),o=r.realmPath,u=r.serverConfig,s=a(o),c=l(u.baseUrl,"oauth2/"+s+"/"+e);return t&&(c+="?"+f(t)),c},e}();var ke,_e,Oe=function(e){void 0===e&&(e=15);var t=-1,n=0;if(e<4||e>15)throw new Error("Invalid nonce length");return function(){var r=Math.pow(10,2)*+new Date;r===t?n++:(n=0,t=r);var o=(r+n).toString();return+o.substr(o.length-e)}},Pe=function(){return(Pe=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ee=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},Te=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Se=function(){function e(){}return e.getTokens=function(e){return Ee(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,s,c,l;return Te(this,(function(f){switch(f.label){case 0:if(e&&e.forceRenew)return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,de.get()];case 2:return(t=f.sent())?[2,t]:[3,4];case 3:return n=f.sent(),console.error("Failed to retrieve stored tokens",n),[3,4];case 4:return r=ge.createVerifier(),o=Oe()().toString(),i=Pe(Pe({},e),{responseType:be.Code,state:o,verifier:r}),[4,Ce.getAuthorizeUrl(i)];case 5:if(a=f.sent(),p=new URL(a),d={},p.searchParams.forEach((function(e,t){return d[t]=e})),(u=d).state!==o)throw new Error("State mismatch");if(!u.code||Array.isArray(u.code))throw new Error("Failed to acquire authorization code");return s=u.code,c=Pe(Pe({},e),{authorizationCode:s,verifier:r}),[4,Ce.getOAuth2Tokens(c)];case 6:t=f.sent(),f.label=7;case 7:return f.trys.push([7,9,,10]),[4,de.set(t)];case 8:return f.sent(),[3,10];case 9:return l=f.sent(),console.error("Failed to store tokens",l),[3,10];case 10:return[2,t]}var p,d}))}))},e.deleteTokens=function(){return Ee(this,void 0,void 0,(function(){return Te(this,(function(e){switch(e.label){case 0:return[4,de.remove()];case 1:return e.sent(),[2]}}))}))},e}(),xe=function(){function e(){}return e.getCurrentUser=function(){return Ce.getUserInfo()},e}(),Ae=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},Me=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Re=function(){function e(){}return e.login=function(e,t){return Ae(this,void 0,void 0,(function(){return Me(this,(function(n){throw console.info(e,t),new Error("FRUser.login() not implemented")}))}))},e.loginWithUI=function(e,t){return Ae(this,void 0,void 0,(function(){var n;return Me(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,e.getSession(t)];case 1:return r.sent(),[4,Se.getTokens({forceRenew:!0})];case 2:return r.sent(),[4,xe.getCurrentUser()];case 3:return[2,r.sent()];case 4:throw n=r.sent(),console.error("test",n),new Error("Login failed");case 5:return[2]}}))}))},e.logout=function(e){return Ae(this,void 0,void 0,(function(){return Me(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,Ce.endSession(e)];case 1:return t.sent(),[4,Ce.revokeToken(e)];case 2:return t.sent(),[4,Se.deleteTokens()];case 3:return t.sent(),[3,5];case 4:throw t.sent(),new Error("Logout failed");case 5:return[2]}}))}))},e}();function Ie(e){try{return e.split("}").filter((function(e){return!!e})).map((function(e){var t=function(e){var t=/new Int8Array\((.+)\)/.exec(e);return null===t||t.length<2?[]:JSON.parse(t[1])}(e);return{id:new Int8Array(t).buffer,type:"public-key"}}))}catch(e){throw new Error("Failed to parse credentials")}}function Ne(e){var t=new Uint8Array(e.response.clientDataJSON);return String.fromCharCode.apply(null,Array.from(t))}function Le(e){return e.replace(/rpId: "(.+)",/,"$1")}!function(e){e.Error="ERROR",e.Unsupported="unsupported"}(ke||(ke={})),function(e){e[e.None=0]="None",e[e.Authentication=1]="Authentication",e[e.Registration=2]="Registration"}(_e||(_e={}));var je=function(){return(je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},Ve=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},Ue=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Fe=function(){function e(){}return e.getWebAuthnStepType=function(e){var t=this.getOutcomeCallback(e),n=this.getMetadataCallback(e);return t&&n?n.getOutputValue("data").acceptableCredentials?_e.Authentication:_e.Registration:_e.None},e.authenticate=function(e){return Ve(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,s;return Ue(this,(function(c){switch(c.label){case 0:if(t=this.getCallbacks(e),n=t.hiddenCallback,r=t.metadataCallback,!n||!r)throw new Error("Invalid webauthn payload");c.label=1;case 1:return c.trys.push([1,3,,4]),i=r.getOutputValue("data"),a=this.createAuthenticationPublicKey(i),[4,this.getAuthenticationCredential(a)];case 2:return u=c.sent(),o=this.getAuthenticationOutcome(u),[3,4];case 3:return s=c.sent(),o=this.getErrorOutcome(s),[3,4];case 4:return n.setInputValue(o),[2,e]}}))}))},e.register=function(e){return Ve(this,void 0,void 0,(function(){var t,n,r,o,i,a,u,s;return Ue(this,(function(c){switch(c.label){case 0:if(t=this.getCallbacks(e),n=t.hiddenCallback,r=t.metadataCallback,!n||!r)throw new Error("Invalid webauthn payload");c.label=1;case 1:return c.trys.push([1,3,,4]),i=r.getOutputValue("data"),a=this.createRegistrationPublicKey(i),[4,this.getRegistrationCredential(a)];case 2:return u=c.sent(),o=this.getRegistrationOutcome(u),[3,4];case 3:return s=c.sent(),o=this.getErrorOutcome(s),[3,4];case 4:return n.setInputValue(o),[2,e]}}))}))},e.getCallbacks=function(e){return{hiddenCallback:this.getOutcomeCallback(e),metadataCallback:this.getMetadataCallback(e)}},e.getMetadataCallback=function(e){return e.getCallbacksOfType(d.MetadataCallback).find((function(e){var t=e.getOutputByName("data",void 0);return t&&t.hasOwnProperty("relyingPartyId")}))},e.getOutcomeCallback=function(e){return e.getCallbacksOfType(d.HiddenValueCallback).find((function(e){return"webAuthnOutcome"===e.getOutputByName("id","")}))},e.getAuthenticationCredential=function(e){return Ve(this,void 0,void 0,(function(){return Ue(this,(function(t){switch(t.label){case 0:return[4,navigator.credentials.get({publicKey:e})];case 1:return[2,t.sent()]}}))}))},e.getAuthenticationOutcome=function(e){if(!window.PublicKeyCredential)return ke.Unsupported;try{if(null===e)throw new Error("No credential provided");var t=Ne(e),n=e.response;return t+"::"+new Int8Array(n.authenticatorData).toString()+"::"+new Int8Array(n.signature).toString()+"::"+e.id}catch(e){return this.getErrorOutcome(e)}},e.getRegistrationCredential=function(e){return Ve(this,void 0,void 0,(function(){return Ue(this,(function(t){switch(t.label){case 0:return[4,navigator.credentials.create({publicKey:e})];case 1:return[2,t.sent()]}}))}))},e.getRegistrationOutcome=function(e){if(!window.PublicKeyCredential)return ke.Unsupported;try{if(null===e)throw new Error("No credential provided");var t=Ne(e),n=e.response;return t+"::"+new Int8Array(n.attestationObject).toString()+"::"+e.id}catch(e){return this.getErrorOutcome(e)}},e.createAuthenticationPublicKey=function(e){var t=e.acceptableCredentials,n=e.challenge,r=e.relyingPartyId,o=e.timeout,i=Le(r);return je({allowCredentials:Ie(t),challenge:Uint8Array.from(atob(n),(function(e){return e.charCodeAt(0)})).buffer,timeout:o},i&&{rpId:i})},e.createRegistrationPublicKey=function(e){var t=function(e){if(e){if(Array.isArray(e))return e;if("string"==typeof e)return e.length>0&&"["===e[0]?JSON.parse(e):(e=e.replace(/(\w+):/g,'"$1":'),JSON.parse("["+e+"]"))}}(e.pubKeyCredParams);if(!t)throw new Error("Missing pubKeyCredParams");var n=e.attestationPreference,r=e.authenticatorSelection,o=e.challenge,i=e.relyingPartyId,a=e.relyingPartyName,u=e.timeout,s=e.userId,c=e.userName,l=Le(i),f=je({name:a},l&&{id:l});return{attestation:n,authenticatorSelection:JSON.parse(r),challenge:Uint8Array.from(atob(o),(function(e){return e.charCodeAt(0)})).buffer,pubKeyCredParams:t,rp:f,timeout:u,user:{displayName:c,id:Int8Array.from(s.split("").map((function(e){return e.charCodeAt(0)}))),name:c}}},e.getErrorOutcome=function(e){var t=e.name?e.name+":":"";return ke.Error+"::"+t+e.message},e}(),Be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),De=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},He=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Be(t,e),t.request=function(e){return De(this,void 0,void 0,(function(){var t;return He(this,(function(n){switch(n.label){case 0:return[4,this._request(e,!1)];case 1:return t=n.sent(),this.newTokenRequired(t,e.requiresNewToken)?[4,this._request(e,!0)]:[3,3];case 2:t=n.sent(),n.label=3;case 3:return[2,t]}}))}))},t._request=function(e,t){return De(this,void 0,void 0,(function(){var n,r,o,i,a;return He(this,(function(s){switch(s.label){case 0:return n=e.url,r=e.init,o=e.timeout,i=new Headers(r.headers),e.bypassAuthentication?[3,2]:[4,Se.getTokens({forceRenew:t})];case 1:a=s.sent(),i.set("authorization","Bearer "+a.accessToken),s.label=2;case 2:return r.headers=i,[4,u(fetch(n,r),o)];case 3:return[2,s.sent()]}}))}))},t.newTokenRequired=function(e,t){return"function"==typeof t?t(e):401===e.status},t}(w),We=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},Ke=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},Ge=function(){function e(){}return e.logout=function(e){return We(this,void 0,void 0,(function(){var t,n,r,o,s,c,f;return Ke(this,(function(p){switch(p.label){case 0:return t=i.get(e),n=t.realmPath,r=t.serverConfig,o={credentials:"include",headers:{"accept-api-version":"protocol=1.0,resource=2.0","x-requested-with":"forgerock-sdk"},method:"POST"},s=a(n),c=l(r.baseUrl,"json/"+s+"/sessions/?_action=logout"),[4,u(fetch(c,o),r.timeout)];case 1:if(!he(f=p.sent()))throw new Error("Failed to log out; received "+f.status);return[2]}}))}))},e}(),Qe=function(){var e=this;this.promise=new Promise((function(t,n){e.reject=n,e.resolve=t}))},Je=function(){function e(e){void 0===e&&(e=!1),this.storage=e?window.localStorage:window.sessionStorage}return e.prototype.get=function(e){var t=this.storage.getItem(e);if(t)return JSON.parse(t)},e.prototype.set=function(e,t){this.storage.setItem(e,JSON.stringify(t))},e.prototype.remove=function(e){this.storage.removeItem(e)},e}();n.d(t,"defaultMessageCreator",(function(){return O})),n.d(t,"nonce",(function(){return Oe})),n.d(t,"AttributeInputCallback",(function(){return R})),n.d(t,"Auth",(function(){return v})),n.d(t,"CallbackType",(function(){return d})),n.d(t,"ChoiceCallback",(function(){return N})),n.d(t,"Config",(function(){return i})),n.d(t,"ConfirmationCallback",(function(){return j})),n.d(t,"Deferred",(function(){return Qe})),n.d(t,"Dispatcher",(function(){return w})),n.d(t,"ErrorCode",(function(){return p})),n.d(t,"FRAuth",(function(){return ce})),n.d(t,"FRCallback",(function(){return A})),n.d(t,"FRLoginFailure",(function(){return S})),n.d(t,"FRLoginSuccess",(function(){return x})),n.d(t,"FRPolicy",(function(){return E})),n.d(t,"FRStep",(function(){return ae})),n.d(t,"FRUser",(function(){return Re})),n.d(t,"FRWebAuthn",(function(){return Fe})),n.d(t,"HiddenValueCallback",(function(){return U})),n.d(t,"HttpClient",(function(){return qe})),n.d(t,"KbaCreateCallback",(function(){return B})),n.d(t,"LocalStorage",(function(){return Je})),n.d(t,"MetadataCallback",(function(){return H})),n.d(t,"NameCallback",(function(){return W})),n.d(t,"OAuth2Client",(function(){return Ce})),n.d(t,"PasswordCallback",(function(){return G})),n.d(t,"PKCE",(function(){return ge})),n.d(t,"PolicyKey",(function(){return g})),n.d(t,"PollingWaitCallback",(function(){return J})),n.d(t,"ReCaptchaCallback",(function(){return Y})),n.d(t,"ResponseType",(function(){return be})),n.d(t,"SessionManager",(function(){return Ge})),n.d(t,"StepType",(function(){return _})),n.d(t,"TermsAndConditionsCallback",(function(){return $})),n.d(t,"TextOutputCallback",(function(){return ee})),n.d(t,"TokenManager",(function(){return Se})),n.d(t,"TokenStorage",(function(){return de})),n.d(t,"UserManager",(function(){return xe})),n.d(t,"ValidatedCreatePasswordCallback",(function(){return ne})),n.d(t,"ValidatedCreateUsernameCallback",(function(){return oe})),n.d(t,"WebAuthnOutcome",(function(){return ke})),n.d(t,"WebAuthnStepType",(function(){return _e}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.el=function(e,t){var n=document.createElement(e);return t&&(n.className=t),n}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(3)),i=function(e,t){var n=this;this.target=e,this.step=t,this.completeStep=function(){return n.render(),n.getRefs(),n.bind(),n.ready(),n.deferred.promise},this.bind=function(){},this.getRefs=function(){},this.getTemplate=function(){return""},this.ready=function(){},this.render=function(){n.target.innerHTML=n.getTemplate()},this.findElement=function(e,t){void 0===t&&(t=!0);var r=n.target.querySelector(e);if(t&&!r)throw new Error('Element "'+e+'" not found');return r},this.deferred=new o.default};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this;this.promise=new Promise((function(t,n){e.reject=n,e.resolve=t}))};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=this;this.button=e,this.enable=function(){t.button.innerHTML=t.text,t.button.disabled=!1},this.disable=function(e){t.button.innerHTML=e||"Verifying...",t.button.disabled=!0},this.bind=function(e){t.button.addEventListener("click",e)},this.unbind=function(e){t.button.removeEventListener("click",e)},this.text=e.innerHTML};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(1);t.renderErrors=function(e,t){if(e&&0!==e.length){var n=e.map((function(e){return r.FRPolicy.parsePolicyRequirement(t,e)})),i=o.el("ul","fr-error");return n.forEach((function(e){var t=o.el("li");t.innerHTML=e,i.appendChild(t)})),i}}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.DeviceAuthentication="DeviceAuthentication",e.DeviceRegistration="DeviceRegistration",e.DeviceRegistrationChoice="DeviceRegistrationChoice",e.LoginSuccess="LoginSuccess",e.OneTimePasswordEmail="OneTimePasswordEmail",e.OneTimePasswordSMS="OneTimePasswordSMS",e.Password="Password",e.PasswordlessChoice="PasswordlessChoice",e.RegistrationSuccess="RegistrationSuccess",e.RegistrationUserInfo="RegistrationUserInfo",e.SecondFactorChoice="SecondFactorChoice",e.Username="Username",e.UsernamePassword="UsernamePassword",e.UserPassword="UserPassword"}(r||(r={})),t.ExpressStage=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=this;this.input=e,this.bind=function(){t.toggler.addEventListener("click",t.onToggle)},this.unbind=function(){t.toggler.removeEventListener("click",t.onToggle)},this.onToggle=function(){t.input.type="text"===t.input.type?"password":"text",t.togglerIcon.innerText="text"===t.input.type?"visibility":"visibility_off"},this.group=e.closest(".form-group"),this.toggler=this.group.querySelector("button"),this.togglerIcon=this.toggler.querySelector("i")};t.default=r},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(9),a=r(n(20));t.BasicStepHandler=a.default;var u=r(n(23));t.default=function(e,t,n){if(!t)throw new Error("Cannot create handler; no step specified");var r=o.FRWebAuthn.getWebAuthnStepType(t);if(r!==o.WebAuthnStepType.None){var s=r===o.WebAuthnStepType.Authentication?i.WebAuthnMode.Authentication:i.WebAuthnMode.Registration;return new u.default(e,t,s)}return new a.default(e,t,n)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Authentication="authentication",e.Registration="registration"}(r||(r={})),t.WebAuthnMode=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(5),i=function(e,t,n){var i=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){return i.input.removeEventListener("change",i.onInput)},this.focus=function(){return i.input.focus()},this.render=function(){var e=r.el("div","fr-callback-"+i.index+" form-check mb-3");i.input=r.el("input","form-check-input"),i.input.checked=i.callback.getInputValue(),i.input.id="fr-callback-"+i.index,i.input.type="checkbox",i.input.addEventListener("change",i.onInput),e.appendChild(i.input);var t=i.callback.getPrompt();if(t){var n=r.el("label","form-check-label");n.innerHTML=t,n.htmlFor=i.input.id,e.appendChild(n)}var a=o.renderErrors(i.callback.getFailedPolicies(),t);return a&&e.appendChild(a),e},this.onInput=function(){i.callback.setValue(i.input.checked),i.onChange(i)}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){return o.input.removeEventListener("change",o.onInput)},this.focus=function(){return o.input.focus()},this.isValid=function(){return o.input&&o.input.value.length>0},this.render=function(){var e=o.callback.getInputValue(),t=r.el("div","fr-callback-"+o.index+" form-group"),n="fr-callback-"+o.index,i=o.callback.getPrompt();if(i){var a=r.el("label");a.innerHTML=i,a.htmlFor=n,t.appendChild(a)}return o.input=r.el("select","form-control"),o.input.id=n,o.input.addEventListener("change",o.onInput),o.callback.getChoices().forEach((function(t,n){var i=r.el("option");i.value=n.toString(),i.text=t,i.selected=n===e,o.input.appendChild(i)})),t.appendChild(o.input),t},this.onInput=function(){o.callback.setChoiceIndex(Number(o.input.value)),o.onChange(o)}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){o.buttons.forEach((function(e){return e.element.removeEventListener("click",e.handler)})),o.buttons=[]},this.focus=function(){return o.buttons[0].element.focus()},this.render=function(){var e=r.el("div","fr-callback-"+o.index+" form-group"),t=o.callback.getPrompt();if(t){var n=r.el("label");n.innerHTML=t,e.appendChild(n)}return o.buttons=o.callback.getOptions().map((function(e,t){var n=function(){return o.onInput(t)},i=r.el("button");return i.className="btn btn-primary mt-3",i.innerHTML=e,i.addEventListener("click",n),{element:i,handler:n}})),o.buttons.forEach((function(t){return e.appendChild(t.element)})),e},this.onInput=function(e){o.callback.setInputValue(e),o.onChange(o)}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(5),i=function(e,t,n){var i=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){return i.input.removeEventListener("keyup",i.onInput)},this.focus=function(){return i.input.focus()},this.isValid=function(){return i.input&&i.input.value.length>0},this.render=function(){var e=r.el("div","fr-callback-"+i.index+" form-group"),t=r.el("div","form-label-group");e.appendChild(t),i.input=r.el("input","form-control"),i.input.id="fr-callback-"+i.index,i.input.type="text",i.input.value=i.callback.getInputValue(),i.input.addEventListener("keyup",i.onInput),t.appendChild(i.input);var n=i.callback.getOutputByName("prompt","");if(n){i.input.placeholder=n;var a=r.el("label");a.innerHTML=n,a.htmlFor=i.input.id,t.appendChild(a)}var u=i.callback.getOutputByName("failedPolicies",[]);if(u.length>0){var s=o.renderErrors(u,n);s&&e.appendChild(s)}return e},this.onInput=function(){i.callback.setInputValue(i.input.value),i.onChange(i)}};t.default=i},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i={answerLabel:"Answer",customLabel:"Custom Question"},a=function(e,t,n,a){var u=this;this.callback=e,this.index=t,this.kbaIndex=n,this.onChange=a,this.destroy=function(){u.select.removeEventListener("change",u.onQuestionChange),u.custom.removeEventListener("keyup",u.onInput),u.answer.removeEventListener("keyup",u.onInput)},this.focus=function(){return u.select.focus()},this.isValid=function(){if(!u.select||!u.custom||!u.answer)return!1;var e=!u.isCustomQuestion()||u.custom.value.length>0,t=u.answer.value.length>0;return e&&t},this.render=function(){var e=o.el("div","fr-callback-"+u.index+" form-group");if(0===u.kbaIndex){var t=o.el("p");t.innerHTML=u.callback.getPrompt(),e.appendChild(t)}var n=u.callback.getPredefinedQuestions(),a=u.callback.getInputValue(0)||n[u.kbaIndex],s=!n.includes(a),c=r(n,[i.customLabel]),l=c.indexOf(s?i.customLabel:a),f=o.el("div","mb-1");u.select=o.el("select","form-control custom-select"),u.select.required=!0,c.forEach((function(e,t){var n=u.createOption(e,t===l);u.select.appendChild(n)})),u.select.addEventListener("change",u.onQuestionChange),f.appendChild(u.select),e.appendChild(f),u.customWrap=o.el("div","form-label-group fr-kba-custom-wrap mb-1 d-none"),u.custom=o.el("input","form-control fr-kba-custom"),u.custom.id="fr-callback-"+u.index+"-custom",u.custom.type="text",u.custom.value=s?a:"",u.custom.addEventListener("keyup",u.onInput),u.customWrap.appendChild(u.custom);var p=o.el("label");p.htmlFor=u.custom.id,p.innerHTML=i.customLabel,u.customWrap.appendChild(p),e.appendChild(u.customWrap);var d=o.el("div","form-label-group mb-0");u.answer=o.el("input","form-control fr-kba-answer"),u.answer.id="fr-callback-"+u.index+"-answer",u.answer.placeholder=i.answerLabel,u.answer.type="text",u.answer.value=u.callback.getInputValue(1),u.answer.addEventListener("keyup",u.onInput),d.appendChild(u.answer);var h=o.el("label");return h.htmlFor=u.answer.id,h.innerHTML=i.answerLabel,d.appendChild(h),e.appendChild(d),u.setView(),e},this.createOption=function(e,t){var n=o.el("option");return n.value=e,n.text=e,n.selected=t,n},this.isCustomQuestion=function(){return u.select.value===i.customLabel},this.onQuestionChange=function(){u.setView(),u.onInput()},this.setView=function(){u.isCustomQuestion()?u.customWrap.classList.remove("d-none"):u.customWrap.classList.add("d-none")},this.onInput=function(){u.isCustomQuestion()?u.callback.setQuestion(u.custom.value):u.callback.setQuestion(u.select.value),u.callback.setAnswer(u.answer.value),u.onChange(u)}};t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(5),i=function(e,t,n){var i=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){i.input.removeEventListener("keyup",i.onInput),i.toggle.removeEventListener("click",i.toggleView)},this.focus=function(){return i.input.focus()},this.isValid=function(){return i.input&&i.input.value.length>0},this.render=function(){var e=r.el("div","fr-callback-"+i.index+" form-group"),t=r.el("div","form-label-group form-label-group-password"),n=r.el("div","form-label-group-input"),a=r.el("div","input-group-append");t.appendChild(n),t.appendChild(a),e.appendChild(t),i.input=r.el("input","form-control"),i.input.id="fr-callback-"+i.index,i.input.addEventListener("keyup",i.onInput),n.appendChild(i.input);var u=i.callback.getPrompt();if(u){i.input.placeholder=u;var s=r.el("label");s.innerHTML=u,s.htmlFor=i.input.id,n.appendChild(s)}i.toggle=r.el("button","btn btn-outline-secondary"),i.toggle.type="button",i.toggle.addEventListener("click",i.toggleView),i.toggleIcon=r.el("i","material-icons material-icons-outlined"),i.toggle.appendChild(i.toggleIcon),a.appendChild(i.toggle);var c=o.renderErrors(i.callback.getFailedPolicies(),u);return c&&e.appendChild(c),i.setView(!1),e},this.setView=function(e){i.input.type=e?"text":"password",i.toggleIcon.innerHTML=e?"visibility_off":"visibility"},this.toggleView=function(){i.setView("password"===i.input.type)},this.onInput=function(){i.callback.setPassword(i.input.value),i.onChange(i)}};t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.render=function(){var e=r.el("div","fr-callback-"+o.index+" form-group");return e.innerHTML=o.callback.getMessage(),e},this.onInjected=function(){var e=o.callback.getWaitTime();window.setTimeout((function(){return o.onChange(o)}),e)}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.result="",this.isValid=function(){return o.result.length>0},this.render=function(){var e=r.el("div","fr-callback-"+o.index+" form-group");return e.appendChild(o.container),e},this.onInjected=function(){if(!window.grecaptcha||"function"!=typeof window.grecaptcha.render)return console.error("reCAPTCHA is not present");window.grecaptcha.render(o.container,{callback:function(e){o.setResult(e)},"expired-callback":function(){o.setResult("")},sitekey:o.callback.getSiteKey()})},this.setResult=function(e){o.result=e,o.callback.setResult(e),o.onChange(o)},this.container=r.el("div","g-recaptcha")};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t,n){var o=this;this.callback=e,this.index=t,this.onChange=n,this.destroy=function(){return o.input.removeEventListener("change",o.onInput)},this.focus=function(){return o.input.focus()},this.isValid=function(){return o.input&&o.input.checked},this.render=function(){var e=r.el("div","fr-callback-"+o.index+" form-group"),t=r.el("p");t.innerHTML=o.callback.getTerms(),e.appendChild(t);var n=r.el("div","form-check mb-3");e.appendChild(n),o.input=r.el("input","form-check-input"),o.input.checked=o.callback.getInputValue(),o.input.id="fr-callback-"+o.index,o.input.type="checkbox",o.input.addEventListener("change",o.onInput),n.appendChild(o.input);var i=r.el("label","form-check-label");return i.innerHTML="I have read and agree to the terms and conditions",i.htmlFor=o.input.id,n.appendChild(i),e},this.onInput=function(){o.callback.setAccepted(o.input.checked),o.onChange(o)}};t.default=o},function(e,t,n){"use strict";var r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);t.AttributeInputCallback=i.AttributeInputCallback,t.Auth=i.Auth,t.CallbackType=i.CallbackType,t.ChoiceCallback=i.ChoiceCallback,t.Config=i.Config,t.ConfirmationCallback=i.ConfirmationCallback,t.defaultMessageCreator=i.defaultMessageCreator,t.Dispatcher=i.Dispatcher,t.ErrorCode=i.ErrorCode,t.FRAuth=i.FRAuth,t.FRCallback=i.FRCallback,t.FRLoginFailure=i.FRLoginFailure,t.FRLoginSuccess=i.FRLoginSuccess,t.FRPolicy=i.FRPolicy,t.FRStep=i.FRStep,t.FRUser=i.FRUser,t.FRWebAuthn=i.FRWebAuthn,t.HiddenValueCallback=i.HiddenValueCallback,t.HttpClient=i.HttpClient,t.KbaCreateCallback=i.KbaCreateCallback,t.LocalStorage=i.LocalStorage,t.MetadataCallback=i.MetadataCallback,t.NameCallback=i.NameCallback,t.OAuth2Client=i.OAuth2Client,t.PasswordCallback=i.PasswordCallback,t.PKCE=i.PKCE,t.PolicyKey=i.PolicyKey,t.PollingWaitCallback=i.PollingWaitCallback,t.ReCaptchaCallback=i.ReCaptchaCallback,t.SessionManager=i.SessionManager,t.StepType=i.StepType,t.TermsAndConditionsCallback=i.TermsAndConditionsCallback,t.TextOutputCallback=i.TextOutputCallback,t.TokenManager=i.TokenManager,t.TokenStorage=i.TokenStorage,t.UserManager=i.UserManager,t.ValidatedCreatePasswordCallback=i.ValidatedCreatePasswordCallback,t.ValidatedCreateUsernameCallback=i.ValidatedCreateUsernameCallback,t.WebAuthnOutcome=i.WebAuthnOutcome,t.WebAuthnStepType=i.WebAuthnStepType;var a=r(n(8));t.basicStepHandlerFactory=a.default,t.BasicStepHandler=a.BasicStepHandler;var u=o(n(10));t.BooleanAttributeCallbackRenderer=u.default;var s=o(n(11));t.ChoiceCallbackRenderer=s.default;var c=o(n(12));t.ConfirmationCallbackRenderer=c.default;var l=o(n(13));t.GenericCallbackRenderer=l.default;var f=o(n(14));t.KbaCreateCallbackRenderer=f.default;var p=o(n(15));t.PasswordCallbackRenderer=p.default;var d=o(n(16));t.PollingWaitCallbackRenderer=d.default;var h=o(n(17));t.ReCaptchaCallbackRenderer=h.default;var b=o(n(18));t.TermsAndConditionsCallbackRenderer=b.default;var y=o(n(25));t.expressStepHandlerFactory=y.default;var v=o(n(2));t.FRStepHandlerBase=v.default;var g=o(n(45));t.FRUI=g.default},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(n(3)),a=n(1),u=r(n(10)),s=r(n(11)),c=r(n(12)),l=r(n(13)),f=r(n(14)),p=r(n(15)),d=r(n(16)),h=r(n(17)),b=r(n(18)),y=r(n(21)),v=r(n(22)),g=function(e,t,n){var r=this;this.target=e,this.step=t,this.rendererFactory=n,this.callbacksThatDontRequireSubmitButton=[o.CallbackType.ConfirmationCallback,o.CallbackType.PollingWaitCallback,"RedirectCallback"],this.completeStep=function(){r.target.innerHTML="",r.container=a.el("div"),r.container.innerHTML=v.default;var e=r.container.querySelector(".fr-form"),t=r.container.querySelector(".fr-buttons");if(!e||!t)throw new Error("Required form targets not found in basic handler view");r.setHeader(),r.renderers=r.createRenderers(),r.renderers.forEach((function(t){e.appendChild(t.render())})),r.target.appendChild(r.container);var n=r.renderers.find((function(e){return!!e.focus}));return void 0!==n&&n.focus(),r.renderers.filter((function(e){return!!e.onInjected})).forEach((function(e){return e.onInjected&&e.onInjected()})),r.requiresSubmitButton()&&(r.submit=r.createSubmitButton(),t.appendChild(r.submit)),r.deferred.promise},this.setHeader=function(){var e=r.container.querySelector("h1");e&&(e.innerHTML=r.step.getHeader()||"")},this.createRenderers=function(){return r.step.callbacks.map(r.createRenderer)},this.createRenderer=function(e,t){if(r.rendererFactory){var n=r.rendererFactory(e,t,r.step,r.onChange);if(n)return n}switch(e.getType()){case o.CallbackType.BooleanAttributeInputCallback:var i=e;return new u.default(i,t,r.onChange);case o.CallbackType.ChoiceCallback:var a=e;return new s.default(a,t,r.onChange);case o.CallbackType.ConfirmationCallback:return new c.default(e,t,r.onChange);case o.CallbackType.PasswordCallback:return new p.default(e,t,r.onChange);case o.CallbackType.ValidatedCreatePasswordCallback:var v=e;return new p.default(v,t,r.onChange);case o.CallbackType.PollingWaitCallback:return new d.default(e,t,r.onChange);case o.CallbackType.ReCaptchaCallback:return new h.default(e,t,r.onChange);case o.CallbackType.TermsAndConditionsCallback:var g=e;return new b.default(g,t,r.onChange);case o.CallbackType.TextOutputCallback:return new y.default(e,t);case o.CallbackType.KbaCreateCallback:var m=e,w=r.step.getCallbacksOfType(o.CallbackType.KbaCreateCallback).filter((function(e){return e.getPrompt()===m.getPrompt()})).indexOf(m);return new f.default(m,t,w,r.onChange);default:return new l.default(e,t,r.onChange)}},this.onChange=function(){var e=r.isValid();r.setSubmitButton(e),!r.submit&&e&&r.resolve()},this.requiresSubmitButton=function(){return 0===r.step.callbacks.filter((function(e){return r.callbacksThatDontRequireSubmitButton.includes(e.getType())})).length},this.createSubmitButton=function(){var e=a.el("button","btn btn-primary");return e.disabled=!r.isValid(),e.id="fr-submit",e.innerText="Next",e.addEventListener("click",r.resolve),e},this.isValid=function(){return!r.renderers.some((function(e){return void 0!==e.isValid&&!e.isValid()}))},this.setSubmitButton=function(e){r.submit&&(r.submit.disabled=void 0!==e?!e:!r.isValid())},this.resolve=function(){r.renderers.filter((function(e){return!!e.destroy})).forEach((function(e){return e.destroy()})),r.submit&&(r.submit.disabled=!0,r.submit.removeEventListener("click",r.resolve)),r.deferred.resolve(r.step)},this.container=a.el("div"),this.container.innerHTML=v.default,this.deferred=new i.default};t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=function(e,t){var n=this;this.callback=e,this.index=t,this.render=function(){var e=r.el("div","fr-callback-"+n.index+" form-group"),t=r.el("p");return t.innerHTML=n.callback.getMessage(),e.appendChild(t),e}};t.default=o},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1></h1>\n    </header>\n    <section class="fr-form">\n    </section>\n    <div class="fr-buttons"></div>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(3)),s=n(9),c=i(n(24)),l=function(e,t,n){var i=this;this.target=e,this.step=t,this.mode=n,this.completeStep=function(){return r(i,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:switch(this.mode){case s.WebAuthnMode.Authentication:return[3,1];case s.WebAuthnMode.Registration:return[3,3]}return[3,5];case 1:return this.message.innerHTML="Please authenticate using your device...",[4,a.FRWebAuthn.authenticate(this.step)];case 2:return e.sent(),this.deferred.resolve(this.step),[3,6];case 3:return this.message.innerHTML="Please register your device...",[4,a.FRWebAuthn.register(this.step)];case 4:return e.sent(),this.deferred.resolve(this.step),[3,6];case 5:throw new Error('Invalid WebAuthn mode "'+this.mode+'"');case 6:return[2,this.deferred.promise]}}))}))},this.target.innerHTML=c.default;var l=this.target.querySelector(".fr-message");if(!l)throw new Error("Required targets not found in webauthn handler view");this.message=l,this.deferred=new u.default};t.default=l},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step">\n  <section class="fr-main">\n    <div class="fr-message">\n      Waiting for device...\n    </div>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),i=r(n(26)),a=r(n(31)),u=r(n(33)),s=r(n(35)),c=r(n(39)),l=r(n(41)),f=r(n(43));t.default=function(e,t){if(!t)throw new Error("Cannot create handler; no step specified");var n=t.getStage();switch(n){case o.ExpressStage.DeviceRegistrationChoice:case o.ExpressStage.PasswordlessChoice:case o.ExpressStage.SecondFactorChoice:return new i.default(e,t);case o.ExpressStage.OneTimePasswordEmail:case o.ExpressStage.OneTimePasswordSMS:case o.ExpressStage.UserPassword:return new s.default(e,t);case o.ExpressStage.Username:return new l.default(e,t);case o.ExpressStage.UsernamePassword:return new f.default(e,t);case o.ExpressStage.DeviceAuthentication:return new a.default(e,t);case o.ExpressStage.DeviceRegistration:return new u.default(e,t);case o.ExpressStage.RegistrationUserInfo:return new c.default(e,t);default:throw new Error('Unsupported stage "'+n+'"')}}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(2)),s=n(27),c=n(6),l=i(n(28)),f=i(n(29)),p=i(n(30)),d="data-choice",h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=void 0,t.bind=function(){t.target.addEventListener("click",t.onClick)},t.unbind=function(){t.target.removeEventListener("click",t.onClick)},t.getTemplate=function(){switch(t.step.getStage()){case c.ExpressStage.DeviceRegistrationChoice:return l.default;case c.ExpressStage.PasswordlessChoice:return f.default;case c.ExpressStage.SecondFactorChoice:return t.renderSecondFactorChoiceTemplate(p.default)}throw new Error('Unsupported choice type "'+t.step.getStage()+'"')},t.onClick=function(e){var n=e.srcElement.getAttribute(d);if(null!==n){var r=Number(n);t.getCallback().setChoiceIndex(r),t.unbind(),t.deferred.resolve(t.step)}},t.renderSecondFactorChoiceTemplate=function(e){var n=t.getCallback().getChoices(),r=t.updateChoiceStrings(n),o=t.getChoicesMarkup(r),i=t.getSubtitleMarkup(r.length);return s.replaceTokens(e,{CHOICES:o,SUBTITLE:i})},t.getCallback=function(){return t.step.getCallbackOfType(a.CallbackType.ChoiceCallback)},t}return o(t,e),t.prototype.getSubtitleMarkup=function(e){return 3===e?"<p>You'll need to verify it's you to continue signing in to your account.</p>":"<p>You'll need a verification code to continue signing in to your account.</p>"},t.prototype.getChoicesMarkup=function(e){return'<ul class="fr-list">\n    '+e.map((function(e,t){return'<li class="fr-list-item fr-icon-list-'+e.icon+'" data-choice="'+t+'">'+e.text+"</li>"})).join("")+"</ul>"},t.prototype.updateChoiceStrings=function(e){var t=2===e.length;return e.map((function(e){var n=e.toLowerCase();switch(e){case"Device":return{icon:n,text:"Use your device"};case"Email":return{icon:n,text:t?"Receive an email":"Email a code"};case"SMS":return{icon:n,text:t?"Receive a text":"Text a code"};default:throw new Error('Unsupported choice "'+e+'"')}}))},t}(u.default);t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.replaceTokens=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e=e.replace(new RegExp("{"+n+"}","g"),t[n]));return e}},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-choice">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Use device sign-in</h1>\n      <i class="fr-icon fr-icon-web-authn"></i>\n      <p>Use your device\'s security features to sign in.</p>\n    </header>\n    <section class="fr-form">\n      <div class="fr-input-group">\n        <button type="button" class="btn btn-primary" data-choice="0">\n          Turn on device sign in\n        </button>\n      </div>\n      <button type="button" class="btn btn-primary mt-3" data-choice="1">\n        More ways to sign in\n      </button>\n    </section>\n  </section>\n</main>'},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-choice">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Go passwordless</h1>\n      <i class="fr-icon fr-icon-web-authn"></i>\n      <p>Never enter your password again by using your device\'s security features to sign in.</p>\n    </header>\n    <section class="fr-form">\n      <div class="fr-input-group">\n        <button type="button" class="btn btn-primary" data-choice="0">\n          Set up passwordless\n        </button>\n      </div>\n      <button type="button" class="btn btn-primary mt-3" data-choice="1">\n        Skip this\n      </button>\n    </section>\n  </section>\n</main>\n'},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-choice">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>2-step verification</h1>\n      <i class="fr-icon fr-icon-check-user"></i>\n      {SUBTITLE}\n    </header>\n  </section>\n  <section class="fr-form">\n    <section>\n      {CHOICES}\n    </section>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),c=u(n(2)),l=u(n(32)),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=void 0,t.getRefs=function(){t.heading=t.findElement("h2")},t.render=function(){t.target.innerHTML=l.default,t.invokeWebAuthn()},t.invokeWebAuthn=function(){return i(t,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return this.heading.innerHTML="Confirming device credentials...",[4,s.FRWebAuthn.authenticate(this.step)];case 1:return e=t.sent(),this.deferred.resolve(e),[2]}}))}))},t}return o(t,e),t}(c.default);t.default=f},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-device-authentication">\n  <section class="fr-main">\n    <header class="fr-header">\n      <div class="fr-spinner"></div>\n      <h2>Waiting for device...</h2>\n    </header>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),c=u(n(2)),l=u(n(34)),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=void 0,t.getRefs=function(){t.heading=t.findElement("h2")},t.render=function(){t.target.innerHTML=l.default,t.invokeWebAuthn()},t.invokeWebAuthn=function(){return i(t,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return this.heading.innerHTML="Acquiring device credentials...",[4,s.FRWebAuthn.register(this.step)];case 1:return e=t.sent(),this.deferred.resolve(e),[2]}}))}))},t}return o(t,e),t}(c.default);t.default=f},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-device-registration">\n  <section class="fr-main">\n    <header class="fr-header">\n      <div class="fr-spinner"></div>\n      <h2>Waiting for device...</h2>\n    </header>\n  </section>\n</main>\n'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(4)),s=i(n(7)),c=i(n(2)),l=i(n(3)),f=n(6),p=i(n(36)),d=i(n(37)),h=i(n(38)),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=function(){return t.deferred=new l.default,t.retryMessage.style.display="block",t.submit.enable(),t.bind(),t.deferred.promise},t.bind=function(){t.submit.bind(t.onSubmit),t.passwordInput.bind()},t.unbind=function(){t.submit.unbind(t.onSubmit),t.passwordInput.unbind()},t.getRefs=function(){t.password=t.findElement("#fr-password"),t.submit=new u.default(t.findElement(".btn-primary")),t.retryMessage=t.findElement(".fr-retry"),t.passwordInput=new s.default(t.password)},t.getTemplate=function(){switch(t.step.getStage()){case f.ExpressStage.OneTimePasswordEmail:return p.default;case f.ExpressStage.OneTimePasswordSMS:return d.default;case f.ExpressStage.UserPassword:return h.default}throw new Error('Unsupported password stage "'+t.step.getStage()+'"')},t.ready=function(){t.password.focus()},t.onSubmit=function(){t.submit.disable(),t.step.setCallbackValue(a.CallbackType.PasswordCallback,t.password.value),t.unbind(),t.deferred.resolve(t.step)},t}return o(t,e),t}(c.default);t.default=b},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-one-time-password-email">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>2-step verification</h1>\n      <i class="fr-icon fr-icon-twofa-email"></i>\n      <p>We\'ve sent a code to your email</p>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Enter code" autofocus />\n            <label for="fr-password">Enter code</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button"><i\n                class="material-icons material-icons-outlined">visibility_off</i></button>\n          </div>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Next</button>\n  </section>\n  <div class="fr-error fr-retry">\n    <div class="fr-alert">Sorry that isnt right. Try again.</div>\n  </div>\n  <footer class="fr-footer">\n    <nav>\n      <ul>\n        <li><a href="#">More ways to sign in</a></li>\n      </ul>\n    </nav>\n  </footer>\n</main>'},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-one-time-password-sms">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>2-step verification</h1>\n      <i class="fr-icon fr-icon-twofa-sms"></i>\n      <p>We\'ve sent a code to your phone</p>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Enter code" autofocus />\n            <label for="fr-password">Enter code</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button">\n              <i class="material-icons material-icons-outlined">visibility_off</i>\n            </button>\n          </div>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Next</button>\n  </section>\n  <div class="fr-error fr-retry">\n    <div class="fr-alert">Sorry that isnt right. Try again.</div>\n  </div>\n  <footer class="fr-footer">\n    <nav>\n      <ul>\n        <li><a href="#">More ways to sign in</a></li>\n      </ul>\n    </nav>\n  </footer>\n</main>\n'},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-username-password">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Sign in</h1>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Password" autofocus />\n            <label for="fr-password">Password</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button"><i\n                class="material-icons material-icons-outlined">visibility_off</i></button>\n          </div>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Next</button>\n    <div class="fr-error fr-retry">\n      <div class="fr-alert">Sorry that isnt right. Try again.</div>\n    </div>\n  </section>\n</main>'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),c=u(n(4)),l=u(n(7)),f=u(n(2)),p=u(n(3)),d=u(n(40)),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=function(){return t.deferred=new p.default,t.retryMessage.style.display="block",t.submit.enable(),t.bind(),t.deferred.promise},t.bind=function(){t.passwordInput.bind(),t.submit.bind(t.onSubmit)},t.unbind=function(){t.passwordInput.unbind(),t.submit.unbind(t.onSubmit)},t.getRefs=function(){t.username=t.findElement("#fr-username"),t.password=t.findElement("#fr-password"),t.passwordInput=new l.default(t.password),t.retryMessage=t.findElement(".fr-retry"),t.submit=new c.default(t.findElement(".btn-primary")),t.addAttributeInputs()},t.getTemplate=function(){return d.default},t.ready=function(){t.username.focus()},t.addAttributeInputs=function(){for(var e=t.findElement("#fr-attributes"),n=[],r=0,o=t.step.getCallbacksOfType(s.CallbackType.StringAttributeInputCallback);r<o.length;r++){var i=o[r],a=i.getName(),u=i.getPrompt();if(a&&u){var c=document.createElement("div");c.className="form-group";var l=document.createElement("div");l.className="form-label-group mb-0";var f=document.createElement("input");f.className="form-control",f.id="fr-"+a,f.name=a,f.placeholder=u,f.required=!0,f.type="text";var p=document.createElement("label");p.htmlFor=f.id,p.innerHTML=u,l.append(f),l.append(p),c.append(l),n.push(c)}}for(;e.firstChild;)e.removeChild(e.firstChild);e.append.apply(e,n)},t.onSubmit=function(){return i(t,void 0,void 0,(function(){var e,t,n,r,o,i;return a(this,(function(a){for(this.submit.disable("Registering..."),this.step.setCallbackValue(s.CallbackType.ValidatedCreateUsernameCallback,this.username.value),this.step.setCallbackValue(s.CallbackType.ValidatedCreatePasswordCallback,this.password.value),e=this.step.getCallbacksOfType(s.CallbackType.StringAttributeInputCallback),t=0,n=e;t<n.length;t++)r=n[t],(o=r.getName())&&(i=this.findElement("#fr-"+o))&&r.setInputValue(i.value);return this.unbind(),this.deferred.resolve(this.step),[2]}))}))},t}return o(t,e),t}(f.default);t.default=h},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-user">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Create an Account</h1>\n    </header>\n    <form class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group mb-0">\n          <input required class="form-control" id="fr-username" type="text" name="username" placeholder="Username"\n            autofocus />\n          <label for="fr-username">Username</label>\n        </div>\n      </div>\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Password" />\n            <label for="fr-password">Password</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button"><i\n                class="material-icons material-icons-outlined">visibility_off</i></button>\n          </div>\n        </div>\n      </div>\n      <div id="fr-attributes"></div>\n    </form>\n    <button type="button" class="btn btn-primary">Register</button>\n    <div class="fr-error fr-retry">\n      <div class="fr-alert">Sorry that isnt right. Try again.</div>\n    </div>\n  </section>\n</main>'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(4)),s=i(n(2)),c=i(n(3)),l=i(n(42)),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=function(){return t.deferred=new c.default,t.retryMessage.style.display="block",t.submit.enable(),t.bind(),t.deferred.promise},t.bind=function(){t.submit.bind(t.onSubmit)},t.unbind=function(){t.submit.unbind(t.onSubmit)},t.getRefs=function(){t.retryMessage=t.findElement(".fr-retry"),t.submit=new u.default(t.findElement(".btn-primary")),t.username=t.findElement("#fr-username")},t.getTemplate=function(){return l.default},t.ready=function(){t.username.focus()},t.onSubmit=function(){t.submit.disable(),t.step.setCallbackValue(a.CallbackType.NameCallback,t.username.value),t.unbind(),t.deferred.resolve(t.step)},t}return o(t,e),t}(s.default);t.default=f},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-username">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Sign in</h1>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group mb-0">\n          <input required class="form-control" id="fr-username" type="text" name="username" placeholder="Username"\n            autofocus />\n          <label for="fr-username">Username</label>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Next</button>\n    <div class="fr-error fr-retry">\n      <div class="fr-alert">Sorry that isnt right. Try again.</div>\n    </div>\n  </section>\n</main>'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),u=i(n(4)),s=i(n(7)),c=i(n(2)),l=i(n(3)),f=i(n(44)),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.retry=function(){return t.deferred=new l.default,t.retryMessage.style.display="block",t.submit.enable(),t.bind(),t.deferred.promise},t.bind=function(){t.submit.bind(t.onSubmit),t.passwordInput.bind()},t.unbind=function(){t.submit.unbind(t.onSubmit),t.passwordInput.unbind()},t.getRefs=function(){t.username=t.findElement("#fr-username"),t.password=t.findElement("#fr-password"),t.retryMessage=t.findElement(".fr-retry"),t.submit=new u.default(t.findElement(".btn-primary")),t.passwordInput=new s.default(t.password)},t.getTemplate=function(){return f.default},t.ready=function(){t.username.focus()},t.onSubmit=function(){t.submit.disable(),t.step.setCallbackValue(a.CallbackType.NameCallback,t.username.value),t.step.setCallbackValue(a.CallbackType.PasswordCallback,t.password.value),t.unbind(),t.deferred.resolve(t.step)},t}return o(t,e),t}(c.default);t.default=p},function(e,t,n){"use strict";n.r(t),t.default='<main class="fr-step fr-username-password">\n  <section class="fr-main">\n    <header class="fr-header">\n      <h1>Sign in</h1>\n    </header>\n    <section class="fr-form">\n      <div class="form-group">\n        <div class="form-label-group mb-0">\n          <input required class="form-control" id="fr-username" type="text" name="username" placeholder="Username"\n            autofocus />\n          <label for="fr-username">Username</label>\n        </div>\n      </div>\n      <div class="form-group">\n        <div class="form-label-group form-label-group-password">\n          <div class="form-label-group-input">\n            <input type="password" id="fr-password" class="form-control" placeholder="Password" />\n            <label for="fr-password">Password</label>\n          </div>\n          <div class="input-group-append">\n            <button class="btn btn-outline-secondary" type="button"><i\n                class="material-icons material-icons-outlined">visibility_off</i></button>\n          </div>\n        </div>\n      </div>\n    </section>\n    <button type="button" class="btn btn-primary">Sign In</button>\n  </section>\n  <div class="fr-error fr-retry">\n    <div class="fr-alert">Sorry that isnt right. Try again.</div>\n  </div>\n</main>'},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(0),c=u(n(8)),l=n(46),f=n(47),p=function(e){function t(t){var n=e.call(this)||this;if(n.options={handlerFactory:c.default,targetId:l.TARGET_ID},n.successfulStages=[],n.getSession=function(e){return i(n,void 0,void 0,(function(){return a(this,(function(t){return this.successfulStages=[],[2,this.nextStep(void 0,e)]}))}))},n.clearState=function(){return n},n.firstStepTimedOut=function(e){var t=0===n.successfulStages.length,r=e.getReason()===s.ErrorCode.Timeout;return t&&r},n.getNewFirstAuthId=function(){return i(n,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,s.FRAuth.next()];case 1:return[2,e.sent().payload.authId]}}))}))},Object.assign(n.options,t),"function"!=typeof n.options.handlerFactory)throw new Error("No step handler factory is specified");var r=n.options.targetId||l.TARGET_ID,o=document.getElementById(r);if(null===o)throw new Error('No element with id "'+r+'" found');return n.el=o,n}return o(t,e),t.prototype.nextStep=function(e,t){return i(this,void 0,void 0,(function(){var n,r,o;return a(this,(function(i){switch(i.label){case 0:return i.trys.push([0,11,,12]),[4,s.FRAuth.next(e,t)];case 1:switch(n=i.sent(),this.dispatchEvent({step:n,type:f.FREventType.StepChange}),n.type){case s.StepType.LoginSuccess:return[3,2];case s.StepType.LoginFailure:return[3,3]}return[3,8];case 2:return[2,n];case 3:return e&&this.firstStepTimedOut(n)?(r=e.payload,[4,this.getNewFirstAuthId()]):[3,5];case 4:return r.authId=i.sent(),[2,this.nextStep(e)];case 5:return this.handler&&this.handler.retry?[4,this.handler.retry()]:[3,7];case 6:return e=i.sent(),[2,this.nextStep(e)];case 7:return[2,n];case 8:if(e&&this.successfulStages.push(e),!this.options.handlerFactory)throw new Error("No handler factory is configured");if(this.handler=this.options.handlerFactory(this.el,n),!this.handler)throw new Error("Handler factory failed to produce a handler");return[4,this.handler.completeStep()];case 9:return n=i.sent(),[2,this.nextStep(n)];case 10:return[3,12];case 11:return o=i.sent(),this.dispatchEvent({step:e,type:f.FREventType.StepError,error:o}),[2,new s.FRLoginFailure({code:0,detail:void 0,message:o.message||"Unknown",reason:"Unknown"})];case 12:return[2]}}))}))},t}(s.Dispatcher);t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TARGET_ID="fr-ui"},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.StepChange="step_change",e.StepError="step_error"}(r||(r={})),t.FREventType=r}])}));
//# sourceMappingURL=index.js.map